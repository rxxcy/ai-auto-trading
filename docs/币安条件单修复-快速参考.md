# å¸å®‰æ¡ä»¶å•ä¿®å¤ - å¿«é€Ÿå‚è€ƒ

## ğŸ¯ æ ¸å¿ƒä¿®æ”¹

### å…³é”®å‚æ•°å˜åŒ–

| å‚æ•° | ä¹‹å‰âŒ | ç°åœ¨âœ… |
|------|-------|-------|
| **algoType** | æ—  | `'CONDITIONAL'` |
| **è§¦å‘ä»·** | `stopPrice` | `triggerPrice` |
| **è®¢å•ID** | `orderId` | `algoId` |
| **è®¢å•ç±»å‹å­—æ®µ** | `order.type` | `order.orderType` |
| **è®¢å•çŠ¶æ€** | `order.status` | `order.algoStatus` |

### APIç«¯ç‚¹å˜åŒ–

| æ“ä½œ | ä¹‹å‰âŒ | ç°åœ¨âœ… |
|------|-------|-------|
| **åˆ›å»º** | POST `/fapi/v1/order` | POST `/fapi/v1/algoOrder` |
| **æŸ¥è¯¢** | GET `/fapi/v1/openOrders` | GET `/fapi/v1/openAlgoOrders` |
| **å–æ¶ˆ** | DELETE `/fapi/v1/order` | DELETE `/fapi/v1/algoOrder` |

## ğŸ“ ä»£ç ç¤ºä¾‹

### åˆ›å»ºæ­¢æŸå•

```typescript
const stopLossData = {
  algoType: 'CONDITIONAL',      // âœ… å¿…å¡«
  symbol: 'BTCUSDT',
  side: 'SELL',
  type: 'STOP_MARKET',
  quantity: '0.001',
  triggerPrice: '40000.00',     // âœ… ä½¿ç”¨ triggerPrice
  workingType: 'MARK_PRICE',
  priceProtect: 'true',
  reduceOnly: 'true'
};

const response = await this.privateRequest('/fapi/v1/algoOrder', stopLossData, 'POST');
const algoId = response.algoId;  // âœ… è¿”å› algoId
```

### æŸ¥è¯¢æ¡ä»¶å•

```typescript
const params = {
  algoType: 'CONDITIONAL',  // âœ… å¿…å¡«
  symbol: 'BTCUSDT'
};

const orders = await this.privateRequest('/fapi/v1/openAlgoOrders', params, 'GET');
```

### å–æ¶ˆæ¡ä»¶å•

```typescript
await this.privateRequest('/fapi/v1/algoOrder', {
  symbol: 'BTCUSDT',
  algoId: '1000000000165597'  // âœ… ä½¿ç”¨ algoId
}, 'DELETE');
```

## âœ… æµ‹è¯•éªŒè¯

è¿è¡Œæµ‹è¯•è„šæœ¬:
```bash
npx tsx scripts/test-binance-algo-orders.ts
```

é¢„æœŸç»“æœ: 4/5 æµ‹è¯•é€šè¿‡

## ğŸš€ éƒ¨ç½²æ­¥éª¤

1. **ç¼–è¯‘æ£€æŸ¥**
   ```bash
   npm run build
   ```

2. **é‡å¯æœåŠ¡**
   ```bash
   pm2 restart ai-trading
   ```

3. **ç›‘æ§æ—¥å¿—**
   ```bash
   pm2 logs ai-trading --lines 100 | grep "æ­¢æŸ\|æ­¢ç›ˆ\|æ¡ä»¶å•\|algoId"
   ```

4. **éªŒè¯åŠŸèƒ½**
   - æ£€æŸ¥æ˜¯å¦æœ‰ -4120 é”™è¯¯
   - ç¡®è®¤æ¡ä»¶å•åˆ›å»ºæˆåŠŸ
   - éªŒè¯ algoId æ­£ç¡®è¿”å›

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **closePosition**: éœ€è¦å…ˆæœ‰æŒä»“æ‰èƒ½ä½¿ç”¨
2. **æµ‹è¯•ç½‘**: ç¡®ä¿ä½¿ç”¨æµ‹è¯•ç½‘APIå¯†é’¥æµ‹è¯•
3. **å­—æ®µæ˜ å°„**: æ‰€æœ‰ `orderId` ç›¸å…³ä»£ç éœ€æ”¹ä¸º `algoId`
4. **æ—¥å¿—æ£€æŸ¥**: å¯†åˆ‡å…³æ³¨åˆ›å»ºåçš„æ—¥å¿—è¾“å‡º

## ğŸ“š ç›¸å…³æ–‡æ¡£

- è¯¦ç»†ä¿®å¤æ€»ç»“: `docs/å¸å®‰æ¡ä»¶å•ä¿®å¤æ€»ç»“-2025-12-10.md`
- æµ‹è¯•è„šæœ¬: `scripts/test-binance-algo-orders.ts`
- ä¸»ç¨‹åºæ–‡ä»¶: `src/exchanges/BinanceExchangeClient.ts`

---
ä¿®å¤æ—¶é—´: 2025-12-10 23:35
çŠ¶æ€: âœ… ä»£ç å·²ä¿®å¤ï¼Œå¾…ç”Ÿäº§éªŒè¯

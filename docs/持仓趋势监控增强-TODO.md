# æŒä»“è¶‹åŠ¿ç›‘æ§å¢å¼ºæ–¹æ¡ˆ v2.0

> **é‡è¦æ›´æ–°**ï¼šåŸºäºå¯¹AIå†³ç­–æµç¨‹çš„æ·±åº¦åˆ†æï¼Œæœ¬æ–¹æ¡ˆå·²å…¨é¢é‡æ„ï¼Œç¡®ä¿ä¸ç°æœ‰é£æ§ä½“ç³»æ— å†²çª

## é—®é¢˜æ·±åº¦åˆ†æ

### 1. æ ¸å¿ƒçŸ›ç›¾è¯†åˆ«

åœ¨ `src/agents/tradingAgent.ts` ç¬¬729-733è¡Œçš„æŒä»“ç®¡ç†æµç¨‹ä¸­ï¼š

```bash
æ­¥éª¤3ï¼šæ£€æŸ¥å¹³ä»“è§¦å‘ï¼ˆæœ€åæ£€æŸ¥ï¼‰
â”œâ”€ å³°å€¼å›æ’¤ â‰¥ 25-35% â†’ å±é™©ä¿¡å·ï¼Œè€ƒè™‘å¹³ä»“
â”œâ”€ è¶‹åŠ¿æ˜ç¡®åè½¬ï¼ˆ3+æ—¶é—´æ¡†æ¶ï¼‰ â†’ è€ƒè™‘å¹³ä»“  âš ï¸ é—®é¢˜æ‰€åœ¨
â”œâ”€ æŒä»“æ—¶é—´ â‰¥ 36å°æ—¶ â†’ å¼ºåˆ¶å¹³ä»“
â””â”€ "æ¥è¿‘æ­¢æŸçº¿"ä¸æ˜¯ä¸»åŠ¨å¹³ä»“ç†ç”±
```

**å…³é”®çŸ›ç›¾ï¼š**

- å¼€ä»“æœºä¼šè¯„åˆ†ç³»ç»Ÿï¼ˆ`analyze_opening_opportunities`ï¼‰è‡ªåŠ¨è¿‡æ»¤å·²æŒä»“å¸ç§ï¼ˆ`includeOpenPositions: false`ï¼‰
- AIåœ¨å†³ç­–æ—¶åªèƒ½è·å¾—**æœªæŒä»“å¸ç§**çš„å¸‚åœºçŠ¶æ€åˆ†æ
- å¯¹äº**å·²æŒä»“å¸ç§**ï¼ŒAIæ— æ³•è·çŸ¥å…¶å®æ—¶è¶‹åŠ¿å˜åŒ–
- æç¤ºè¯è¦æ±‚"è¶‹åŠ¿æ˜ç¡®åè½¬â†’è€ƒè™‘å¹³ä»“"ï¼Œä½†AIæ— æ³•åˆ¤æ–­è¶‹åŠ¿æ˜¯å¦åè½¬

### 2. å†³ç­–æµç¨‹å†²çªåˆ†æ

#### ç°æœ‰é£æ§ä½“ç³»ï¼ˆä¸‰å±‚ä¿æŠ¤ï¼‰

```bash
ã€ç¬¬ä¸€å±‚ã€‘äº¤æ˜“æ‰€æœåŠ¡å™¨ç«¯è‡ªåŠ¨æ‰§è¡Œï¼ˆç¡¬æ€§åº•çº¿ï¼‰
â”œâ”€ ç§‘å­¦æ­¢æŸå•ï¼šè§¦åŠç«‹å³å¹³ä»“ï¼ˆ24/7ç›‘æ§ï¼‰
â””â”€ æç«¯æ­¢ç›ˆå•ï¼š5Rå…œåº•ä¿æŠ¤

ã€ç¬¬äºŒå±‚ã€‘ç¨‹åºåŒ–è§„åˆ™ï¼ˆæ­¥éª¤1-2ï¼‰
â”œâ”€ åˆ†æ‰¹æ­¢ç›ˆï¼š1Râ†’2Râ†’3R é€æ­¥é”å®šåˆ©æ¶¦
â””â”€ ç§»åŠ¨æ­¢æŸï¼šä¼˜åŒ–ç›ˆåˆ©æŒä»“ä¿æŠ¤

ã€ç¬¬ä¸‰å±‚ã€‘AIä¸»åŠ¨å†³ç­–ï¼ˆæ­¥éª¤3ï¼‰
â”œâ”€ å³°å€¼å›æ’¤ä¿æŠ¤ï¼šâ‰¥25---

## é™„å½•Dï¼šPromptä¼˜åŒ–è¯„ä¼° - åŸå§‹æŒ‡æ ‡è£å‰ªåˆ†æ

### é—®é¢˜æå‡º

åœ¨ä¸ºæŒä»“æ·»åŠ å¸‚åœºçŠ¶æ€åˆ†æåï¼Œæ˜¯å¦å¯ä»¥çœç•¥åŸå§‹çš„æŠ€æœ¯æŒ‡æ ‡è¾“å‡ºï¼ˆä»·æ ¼åºåˆ—ã€RSIã€MACDç­‰ï¼‰ï¼Œä»è€Œå‡å°‘Prompté•¿åº¦ï¼Ÿ

### é£é™©è¯„ä¼°çŸ©é˜µ

| åœºæ™¯ | åŸå§‹æŒ‡æ ‡çš„å¿…è¦æ€§ | é£é™©ç­‰çº§ | è¯´æ˜ |
|------|----------------|---------|------|
| **æŒä»“ç®¡ç†** | âš ï¸ ä¸­ç­‰ | ä¸­ | æœ‰å¸‚åœºçŠ¶æ€åï¼Œç†è®ºä¸Šå¯ä»¥ä¸çœ‹åŸå§‹æŒ‡æ ‡ |
| **æ–°å¼€ä»“è¯„ä¼°** | âœ… å¿…éœ€ | é«˜ | `analyze_opening_opportunities`éœ€è¦åŸå§‹æ•°æ® |
| **è¶‹åŠ¿ç»†èŠ‚åˆ¤æ–­** | âš ï¸ é‡è¦ | ä¸­ | AIå¯èƒ½éœ€è¦æŸ¥çœ‹RSIå…·ä½“æ•°å€¼æ¥åˆ¤æ–­è¶…ä¹°è¶…å–ç¨‹åº¦ |
| **å¼‚å¸¸æƒ…å†µå¤„ç†** | âœ… å¿…éœ€ | é«˜ | å¸‚åœºçŠ¶æ€åˆ†æå¤±è´¥æ—¶ï¼ŒåŸå§‹æ•°æ®æ˜¯å”¯ä¸€ä¿¡æ¯æº |
| **AIè‡ªä¸»æ´å¯Ÿ** | âš ï¸ é‡è¦ | ä¸­ | AIå¯èƒ½ä»ä»·æ ¼åºåˆ—ä¸­å‘ç°çŠ¶æ€åˆ†ææœªè¦†ç›–çš„æ¨¡å¼ |

### æ·±åº¦åˆ†æ

#### 1. å¼€ä»“å†³ç­–ï¼šä¸å¯çœç•¥

**åŸå› **ï¼š
- `analyze_opening_opportunities` å·¥å…·åªè¿”å›**æœªæŒä»“å¸ç§**çš„è¯„åˆ†
- AIåœ¨é€‰æ‹©å¼€ä»“å¸ç§æ—¶ï¼Œä»éœ€è¦æŸ¥çœ‹åŸå§‹å¸‚åœºæ•°æ®
- ä¾‹å¦‚ï¼šå·¥å…·æ¨èBTC 85åˆ†ã€ETH 82åˆ†ï¼ŒAIå¯èƒ½æƒ³çœ‹ä¸¤è€…çš„RSIå·®å¼‚æ¥å†³ç­–

**ç»“è®º**ï¼šâœ… **å¿…é¡»ä¿ç•™æ‰€æœ‰å¯äº¤æ˜“å¸ç§çš„åŸå§‹æŒ‡æ ‡**

#### 2. æŒä»“ç®¡ç†ï¼šå¯ä»¥ç®€åŒ–ä½†ä¸èƒ½å®Œå…¨çœç•¥

**åœºæ™¯åˆ†æ**ï¼š

##### åœºæ™¯Aï¼šå¸‚åœºçŠ¶æ€åˆ†ææ­£å¸¸
- âœ… å¯ä»¥çœç•¥ï¼šæŒä»“å¸ç§çš„å®Œæ•´ä»·æ ¼åºåˆ—ï¼ˆå¦‚20ä¸ª3åˆ†é’ŸKçº¿ï¼‰
- âœ… å¯ä»¥çœç•¥ï¼šå¤šä¸ªæ—¶é—´æ¡†æ¶çš„é‡å¤æŒ‡æ ‡
- âš ï¸ åº”ä¿ç•™ï¼šå½“å‰ä»·æ ¼ã€å½“å‰RSIã€å½“å‰MACDï¼ˆç”¨äºéªŒè¯çŠ¶æ€å‡†ç¡®æ€§ï¼‰

##### åœºæ™¯Bï¼šå¸‚åœºçŠ¶æ€åˆ†æå¤±è´¥
- âŒ ä¸å¯çœç•¥ï¼šå¦‚æœ `analyzeMarketState()` è°ƒç”¨å¤±è´¥ï¼ŒåŸå§‹æŒ‡æ ‡æ˜¯å”¯ä¸€ä¿¡æ¯æº
- âš ï¸ é™çº§æ–¹æ¡ˆï¼šAIéœ€è¦ä¾èµ–åŸå§‹æ•°æ®åšå‡ºåˆ¤æ–­

##### åœºæ™¯Cï¼šAIéœ€è¦æ·±åº¦åˆ†æ
- ä¾‹å¦‚ï¼šå¸‚åœºçŠ¶æ€æ˜¾ç¤º"è½»åº¦è¶…ä¹°"ï¼ˆRSI=72ï¼‰
- AIå¯èƒ½æƒ³çŸ¥é“ï¼šRSIæ˜¯ä»50ä¸Šå‡åˆ°72ï¼ˆå¼ºåŠ¿ï¼‰ï¼Œè¿˜æ˜¯ä»90å›è½åˆ°72ï¼ˆèµ°å¼±ï¼‰ï¼Ÿ
- å¦‚æœåªæœ‰çŠ¶æ€ï¼Œç¼ºå°‘RSIåºåˆ—ï¼ŒAIæ— æ³•åˆ¤æ–­åŠ¨é‡å˜åŒ–

#### 3. å¼‚å¸¸å¤„ç†å®¹é”™

**å½“å‰å®ç°**ï¼š
```typescript
try {
  marketStates = await analyzeMultipleMarketStates(positionSymbols);
} catch (error) {
  logger.warn(`å¸‚åœºçŠ¶æ€åˆ†æå¤±è´¥: ${error}`);
  // ç»§ç»­æ‰§è¡Œï¼Œä½†marketStatesä¸ºç©º
}
```

**å¦‚æœçœç•¥åŸå§‹æŒ‡æ ‡**ï¼š

- âŒ åˆ†æå¤±è´¥æ—¶ï¼ŒAIå¯¹æŒä»“å¸ç§å®Œå…¨å¤±æ˜
- âŒ æ— æ³•åšå‡ºä»»ä½•æœ‰æ•ˆçš„æŒä»“ç®¡ç†å†³ç­–
- âŒ ç³»ç»Ÿå¯ç”¨æ€§ä¸¥é‡ä¸‹é™

### ä¼˜åŒ–æ–¹æ¡ˆï¼šåˆ†çº§ç®€åŒ–

#### æ–¹æ¡ˆAï¼šæ™ºèƒ½åˆ†å±‚å±•ç¤ºï¼ˆæ¨èï¼‰

**å®æ–½ç­–ç•¥**ï¼š

1. **æŒä»“å¸ç§**ï¼šå±•ç¤ºå¸‚åœºçŠ¶æ€ + ç²¾ç®€åŸå§‹æŒ‡æ ‡
   - âœ… ä¿ç•™ï¼šå½“å‰ä»·ã€å½“å‰RSI(7/14)ã€å½“å‰MACD
   - âŒ çœç•¥ï¼šå®Œæ•´ä»·æ ¼åºåˆ—ï¼ˆ20ä¸ªæ•°æ®ç‚¹ï¼‰
   - âŒ çœç•¥ï¼šå¤šæ—¶é—´æ¡†æ¶çš„é‡å¤å±•ç¤ºï¼ˆ1m/3m/5m/15m/30m/1hï¼‰

2. **éæŒä»“å¸ç§**ï¼šä¿æŒå®Œæ•´åŸå§‹æŒ‡æ ‡
   - âœ… ä¿ç•™ï¼šæ‰€æœ‰å¸‚åœºæ•°æ®ï¼ˆç”¨äºå¼€ä»“å†³ç­–ï¼‰
   - ç†ç”±ï¼šå¼€ä»“å†³ç­–éœ€è¦å…¨é¢æ•°æ®æ”¯æŒ

**é¢„æœŸæ•ˆæœ**ï¼š

- Prompté•¿åº¦å‡å°‘ï¼šçº¦30-40%ï¼ˆé’ˆå¯¹æŒä»“å¸ç§éƒ¨åˆ†ï¼‰
- é£é™©ï¼šä½ï¼ˆä¿ç•™äº†å…³é”®æ•°æ®å’Œå®¹é”™èƒ½åŠ›ï¼‰

#### æ–¹æ¡ˆBï¼šæ¡ä»¶å±•ç¤ºï¼ˆæ¿€è¿›ä¼˜åŒ–ï¼‰

**å®æ–½ç­–ç•¥**ï¼š

```typescript
// åªæœ‰åœ¨å¸‚åœºçŠ¶æ€åˆ†æå¤±è´¥æ—¶ï¼Œæ‰å±•ç¤ºå®Œæ•´åŸå§‹æŒ‡æ ‡
if (!marketStateSuccess) {
  // å±•ç¤ºå®Œæ•´åŸå§‹æ•°æ®ä½œä¸ºé™çº§æ–¹æ¡ˆ
  prompt += `[å¸‚åœºçŠ¶æ€åˆ†æå¤±è´¥ï¼Œå±•ç¤ºåŸå§‹æ•°æ®]\n`;
  prompt += fullMarketDataOutput;
} else {
  // åªå±•ç¤ºç²¾ç®€ç‰ˆæœ¬
  prompt += summarizedOutput;
}
```

**é£é™©**ï¼š

- âš ï¸ é«˜ï¼šAIå¤±å»å¯¹åŸå§‹æ•°æ®çš„ç›´æ¥è®¿é—®
- âš ï¸ ä¸­ï¼šå¯èƒ½é”™è¿‡å¸‚åœºçŠ¶æ€åˆ†ææœªè¦†ç›–çš„ç»†èŠ‚æ¨¡å¼

#### æ–¹æ¡ˆCï¼šä¿æŒç°çŠ¶ï¼ˆæœ€ä¿å®ˆï¼‰

**ç†ç”±**ï¼š

- å½“å‰Prompté•¿åº¦åœ¨å¯æ¥å—èŒƒå›´å†…ï¼ˆçº¦5000-8000 tokensï¼‰
- GPT-4çš„128kä¸Šä¸‹æ–‡çª—å£å®Œå…¨è¶³å¤Ÿ
- è¿‡åº¦ä¼˜åŒ–å¯èƒ½å¸¦æ¥æ„å¤–é£é™©

**å»ºè®®**ï¼šå…ˆå®æ–½è¶‹åŠ¿ç›‘æ§å¢å¼ºï¼Œè§‚å¯Ÿæ•ˆæœåå†è€ƒè™‘ä¼˜åŒ–

### æœ€ç»ˆå»ºè®®ï¼šåˆ†é˜¶æ®µå®æ–½

#### Phase 1ï¼šå®æ–½è¶‹åŠ¿ç›‘æ§å¢å¼ºï¼ˆä¼˜å…ˆï¼‰

- æŒ‰ç…§v2.0æ–¹æ¡ˆï¼Œä¸ºæŒä»“æ·»åŠ å¸‚åœºçŠ¶æ€ä¿¡æ¯
- **ä¸æ”¹åŠ¨**åŸå§‹æŒ‡æ ‡è¾“å‡º
- è§‚å¯ŸAIå†³ç­–è´¨é‡å’ŒPrompté•¿åº¦

#### Phase 2ï¼šç›‘æ§å’Œè¯„ä¼°ï¼ˆ1-2å‘¨ï¼‰

- ç»Ÿè®¡AIæ˜¯å¦é¢‘ç¹æŸ¥çœ‹æŒä»“å¸ç§çš„åŸå§‹æŒ‡æ ‡
- åˆ†æAIå†³ç­–æ˜¯å¦ä¸»è¦ä¾èµ–å¸‚åœºçŠ¶æ€
- è¯„ä¼°Prompté•¿åº¦æ˜¯å¦æˆä¸ºç“¶é¢ˆ

#### Phase 3ï¼šæ¡ä»¶æ€§ä¼˜åŒ–ï¼ˆå¦‚æœ‰å¿…è¦ï¼‰

- å¦‚æœPhase 2æ˜¾ç¤ºAIå¾ˆå°‘ä½¿ç”¨æŒä»“å¸ç§çš„ä»·æ ¼åºåˆ—
- å®æ–½**æ–¹æ¡ˆAï¼ˆæ™ºèƒ½åˆ†å±‚å±•ç¤ºï¼‰**
- ä¿ç•™å…³é”®æŒ‡æ ‡ï¼Œçœç•¥å†—ä½™åºåˆ—

### ä»£ç å®ç°é¢„è§ˆï¼ˆæ–¹æ¡ˆAï¼‰

```typescript
// åœ¨ generateTradingPrompt() ä¸­
const positionSymbols = positions.map(p => p.symbol);

for (const [symbol, dataRaw] of Object.entries(marketData)) {
  const data = dataRaw as any;
  const isPositionSymbol = positionSymbols.includes(symbol);
  
  prompt += `\n${symbol} å¸‚åœºæ•°æ®\n`;
  
  // å½“å‰ä»·æ ¼ï¼ˆæ‰€æœ‰å¸ç§éƒ½æ˜¾ç¤ºï¼‰
  prompt += `å½“å‰ä»·æ ¼ = ${formatPrice(data.price)}\n`;
  
  if (isPositionSymbol) {
    // ã€æŒä»“å¸ç§ã€‘ç²¾ç®€ç‰ˆæœ¬
    prompt += `å½“å‰RSI7 = ${formatPercent(data.rsi7, 3)}, `;
    prompt += `å½“å‰RSI14 = ${formatPercent(data.rsi14, 3)}, `;
    prompt += `å½“å‰MACD = ${formatPrice(data.macd)}\n`;
    
    // âš ï¸ çœç•¥ï¼šä»·æ ¼åºåˆ—ã€å¤šæ—¶é—´æ¡†æ¶è¯¦æƒ…
    // âœ… æ³¨æ„ï¼šå¸‚åœºçŠ¶æ€ä¿¡æ¯ä¼šåœ¨æŒä»“éƒ¨åˆ†å±•ç¤º
    
  } else {
    // ã€éæŒä»“å¸ç§ã€‘å®Œæ•´ç‰ˆæœ¬
    prompt += `å½“å‰EMA20 = ${formatPrice(data.ema20)}, `;
    prompt += `å½“å‰MACD = ${formatPrice(data.macd)}, `;
    prompt += `å½“å‰RSI7 = ${formatPercent(data.rsi7, 3)}\n\n`;
    
    // å®Œæ•´çš„ä»·æ ¼åºåˆ—ã€å¤šæ—¶é—´æ¡†æ¶ç­‰
    if (data.intradaySeries) {
      prompt += `æ—¥å†…åºåˆ—: [...]`; // ä¿ç•™å®Œæ•´æ•°æ®
    }
    
    if (data.timeframes) {
      prompt += `å¤šæ—¶é—´æ¡†æ¶æŒ‡æ ‡: [...]`; // ä¿ç•™å®Œæ•´æ•°æ®
    }
  }
}
```

### é‡åŒ–è¯„ä¼°

| æŒ‡æ ‡ | å½“å‰ | æ–¹æ¡ˆA | èŠ‚çœ |
|------|------|-------|------|
| æ¯ä¸ªæŒä»“å¸ç§Tokens | ~800 | ~200 | 75% |
| 3ä¸ªæŒä»“æ€»Tokens | ~2400 | ~600 | 75% |
| æ€»Prompt Tokens | ~6000 | ~4200 | 30% |
| é£é™©ç­‰çº§ | æ—  | ä½ | - |

### å†³ç­–å»ºè®®

**æ¨èæ–¹æ¡ˆ**ï¼š**å…ˆå®æ–½v2.0æ–¹æ¡ˆï¼Œæš‚ä¸ä¼˜åŒ–åŸå§‹æŒ‡æ ‡**

**ç†ç”±**ï¼š

1. âœ… å½“å‰Prompté•¿åº¦ä¸æ˜¯ç“¶é¢ˆï¼ˆ6k tokens << 128k limitï¼‰
2. âœ… ä¿æŒä¿¡æ¯å®Œæ•´æ€§ï¼Œé™ä½æœªçŸ¥é£é™©
3. âœ… å…ˆéªŒè¯è¶‹åŠ¿ç›‘æ§å¢å¼ºçš„æ•ˆæœ
4. âœ… æœªæ¥å¯æ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µå†ä¼˜åŒ–

**å¦‚æœå¿…é¡»ä¼˜åŒ–**ï¼š

- é‡‡ç”¨**æ–¹æ¡ˆAï¼ˆæ™ºèƒ½åˆ†å±‚å±•ç¤ºï¼‰**
- æŒä»“å¸ç§ä¿ç•™å…³é”®æŒ‡æ ‡ï¼Œçœç•¥åºåˆ—æ•°æ®
- éæŒä»“å¸ç§ä¿æŒå®Œæ•´
- æ·»åŠ å¼‚å¸¸å¤„ç†ï¼Œç¡®ä¿åˆ†æå¤±è´¥æ—¶æœ‰é™çº§æ–¹æ¡ˆ

### å®æ–½æ£€æŸ¥æ¸…å•

å¦‚æœå†³å®šå®æ–½æ–¹æ¡ˆAï¼š

- [ ] è¯†åˆ«æŒä»“å¸ç§åˆ—è¡¨
- [ ] ä¸ºæŒä»“å¸ç§ç”Ÿæˆç²¾ç®€ç‰ˆå¸‚åœºæ•°æ®
- [ ] ä¸ºéæŒä»“å¸ç§ä¿ç•™å®Œæ•´å¸‚åœºæ•°æ®
- [ ] æ·»åŠ å¸‚åœºçŠ¶æ€åˆ†æå¤±è´¥çš„é™çº§å¤„ç†
- [ ] åœ¨æŒä»“ä¿¡æ¯éƒ¨åˆ†å±•ç¤ºå¸‚åœºçŠ¶æ€ï¼ˆè¡¥å¿åŸå§‹æ•°æ®çš„ç¼ºå¤±ï¼‰
- [ ] æµ‹è¯•AIå†³ç­–è´¨é‡æ˜¯å¦ä¸‹é™
- [ ] å¯¹æ¯”Prompté•¿åº¦ä¼˜åŒ–æ•ˆæœ

---

*æœ¬æ–¹æ¡ˆ v2.0 åŸºäºå¯¹AIå†³ç­–æµç¨‹çš„æ·±åº¦åˆ†æé‡æ–°è®¾è®¡ï¼Œç¡®ä¿ä¸ç°æœ‰é£æ§ä½“ç³»æ— å†²çª*% ç«‹å³å¹³ä»“
â”œâ”€ è¶‹åŠ¿åè½¬è¯†åˆ«ï¼šâš ï¸ ä¿¡æ¯ç¼ºå¤±å¯¼è‡´æ— æ³•æ‰§è¡Œ
â””â”€ æ—¶é—´é™åˆ¶ï¼šâ‰¥36å°æ—¶å¼ºåˆ¶å¹³ä»“

#### å…³é”®å‘ç°

1. **ä¿¡æ¯æ¥æºæ–­è£‚**ï¼š
   - å¼€ä»“å†³ç­–ï¼šåŸºäº `analyzeMarketState()` ç§‘å­¦è¯†åˆ«8ç§å¸‚åœºçŠ¶æ€
   - æŒä»“ç®¡ç†ï¼šåªæœ‰åŸå§‹æŒ‡æ ‡ï¼ˆä»·æ ¼ã€RSIã€MACDï¼‰ï¼Œéœ€AIè‡ªè¡Œåˆ¤æ–­
   - è¿™è¿èƒŒäº†ç³»ç»Ÿ"ç¨‹åºåŒ–+AIè¾…åŠ©"çš„è®¾è®¡ç†å¿µ

2. **å†³ç­–ä¼˜å…ˆçº§æ··ä¹±**ï¼š
   - æ­¥éª¤3æ˜¯"æœ€åæ£€æŸ¥"ï¼Œæ„å‘³ç€**è¾…åŠ©æ€§è´¨**
   - ä½†"è¶‹åŠ¿åè½¬"åº”è¯¥æ˜¯**æ ¸å¿ƒé£æ§ä¿¡å·**ï¼Œä¸åº”æ”¾åœ¨æœ€å
   - ä¸"åˆ†æ‰¹æ­¢ç›ˆ"ï¼ˆæ­¥éª¤1ï¼‰çš„ä¼˜å…ˆçº§å…³ç³»ä¸æ¸…æ™°

3. **ä¸ç°æœ‰è§„åˆ™çš„æ½œåœ¨å†²çª**ï¼š
   - å¦‚æœè¶‹åŠ¿åè½¬ä¿¡å·ä¸åˆ†æ‰¹æ­¢ç›ˆç­–ç•¥å†²çªæ€ä¹ˆåŠï¼Ÿ
   - ä¾‹å¦‚ï¼šæŒä»“å·²è¾¾2Rï¼Œåº”æ‰§è¡Œåˆ†æ‰¹æ­¢ç›ˆï¼Œä½†åŒæ—¶æ£€æµ‹åˆ°è¶‹åŠ¿åè½¬
   - æ˜¯åº”è¯¥åˆ†æ‰¹å¹³ä»“33%ï¼Œè¿˜æ˜¯å…¨éƒ¨å¹³ä»“ï¼Ÿ

### 3. å½±å“èŒƒå›´è¯„ä¼°

| å½±å“ç»´åº¦ | ä¸¥é‡ç¨‹åº¦ | å…·ä½“è¡¨ç° |
|---------|---------|---------|
| é£é™©æ§åˆ¶ | âš ï¸ é«˜ | æ— æ³•ä¸»åŠ¨è¯†åˆ«è¶‹åŠ¿åè½¬ï¼Œä¾èµ–è¢«åŠ¨æ­¢æŸ |
| å†³ç­–è´¨é‡ | âš ï¸ é«˜ | æŒä»“ç®¡ç†ç²¾å‡†åº¦ä½äºå¼€ä»“å†³ç­– |
| ç³»ç»Ÿä¸€è‡´æ€§ | âš ï¸ ä¸­ | å¼€ä»“ç¨‹åºåŒ–ï¼ŒæŒä»“ç®¡ç†é AIä¸»è§‚åˆ¤æ–­ |
| å¯è¿½æº¯æ€§ | âš ï¸ ä¸­ | æ— æ³•è®°å½•è¶‹åŠ¿å˜åŒ–å†å² |
| ç”¨æˆ·ä½“éªŒ | âš ï¸ ä½ | å¯èƒ½é”™è¿‡ä¸»åŠ¨ç¦»åœºæœºä¼šï¼Œæ‰¿å—æ›´å¤§å›æ’¤ |

## é‡æ„æ–¹æ¡ˆï¼šè¶‹åŠ¿ç›‘æ§å¢å¼º + å†³ç­–æµç¨‹ä¼˜åŒ–

### æ ¸å¿ƒè®¾è®¡ç†å¿µ

- **å…³é”®åŸåˆ™ï¼šè¶‹åŠ¿åè½¬ä¿¡æ¯åº”ä½œä¸º"å†³ç­–å‚è€ƒ"ï¼Œè€Œé"å¼ºåˆ¶è§¦å‘å™¨"**

ç†ç”±ï¼š

1. **å°Šé‡ç°æœ‰é£æ§ä½“ç³»**ï¼šç§‘å­¦æ­¢æŸã€åˆ†æ‰¹æ­¢ç›ˆå·²ç»æä¾›äº†å®Œå–„çš„ä¿æŠ¤
2. **é¿å…å†³ç­–å†²çª**ï¼šä¸åœ¨æ­¥éª¤1-2çš„ç¨‹åºåŒ–è§„åˆ™ä¸Šå åŠ æ–°çš„å¼ºåˆ¶è§„åˆ™
3. **å¢å¼ºè€Œéæ›¿ä»£**ï¼šä¸ºAIæä¾›æ›´å¤šä¿¡æ¯ï¼Œä½†ä¿ç•™AIçš„è‡ªä¸»åˆ¤æ–­æƒ
4. **ä¿¡æ¯å¯¹ç§°æ€§**ï¼šè®©æŒä»“ç®¡ç†ä¸å¼€ä»“å†³ç­–äº«æœ‰åŒç­‰è´¨é‡çš„å¸‚åœºåˆ†æ

### æ–¹æ¡ˆè®¾è®¡ï¼ˆä¸‰å±‚æ¶æ„ï¼‰

#### ç¬¬ä¸€å±‚ï¼šæ•°æ®å¢å¼ºï¼ˆæ ¸å¿ƒï¼‰

**ç›®æ ‡**ï¼šåœ¨ `generateTradingPrompt()` ä¸­ä¸ºæŒä»“æ·»åŠ å¸‚åœºçŠ¶æ€ä¿¡æ¯

**å®æ–½æ–¹å¼**ï¼š

1. åœ¨ç”ŸæˆæŒä»“ä¿¡æ¯æ—¶ï¼Œè°ƒç”¨ `analyzeMultipleMarketStates()` æ‰¹é‡åˆ†ææŒä»“å¸ç§
2. åœ¨æŒä»“å±•ç¤ºä¸­å¢åŠ å¸‚åœºçŠ¶æ€å­—æ®µï¼ˆä½†ä¸æ”¹å˜å±•ç¤ºä¼˜å…ˆçº§ï¼‰
3. ä¿æŒç°æœ‰çš„æŒä»“ä¿¡æ¯ç»“æ„ï¼Œä»…è¿½åŠ è¶‹åŠ¿ä¿¡æ¯

**ç¤ºä¾‹è¾“å‡º**ï¼š

```markdown
ã€æŒä»“1ã€‘BTC/USDT (åšå¤š)
â”œâ”€ åŸºç¡€ä¿¡æ¯ï¼šæ•°é‡0.5 BTC, å…¥åœºä»·$58,000, å½“å‰ä»·$58,500
â”œâ”€ ç›ˆäºï¼š+0.86% (åŸå§‹) â†’ +8.6% (10xæ æ†), R-Multiple: 0.43R
â”œâ”€ é£æ§çŠ¶æ€ï¼šæ­¢æŸ$56,000 (-3.45%), å³°å€¼å›æ’¤12%, æŒä»“20å°æ—¶
â”œâ”€ ğŸ“Š å¸‚åœºè¶‹åŠ¿åˆ†æï¼ˆä¾›å†³ç­–å‚è€ƒï¼‰ï¼š
â”‚   â€¢ å½“å‰çŠ¶æ€: downtrend_continuation (ä¸‹è·Œè¶‹åŠ¿å»¶ç»­)
â”‚   â€¢ è¶‹åŠ¿å¼ºåº¦: trending_down (æ˜ç¡®ä¸‹è·Œ)
â”‚   â€¢ åŠ¨é‡çŠ¶æ€: overbought_mild (è½»åº¦è¶…ä¹°ï¼Œåå¼¹åŠ›åº¦å‡å¼±)
â”‚   â€¢ åè½¬ä¿¡å·: âš ï¸ æ˜¯ (3ä¸ªæ—¶é—´æ¡†æ¶ç¡®è®¤ï¼Œå…¥åœºæ—¶ä¸ºuptrend_oversold)
â”‚   â€¢ å¤šæ—¶é—´æ¡†æ¶ä¸€è‡´æ€§: 85% (15m/1h/4hå‡ä¸ºä¸‹è·Œ)
â”‚   â€¢ åˆ†æç½®ä¿¡åº¦: 85%
â””â”€ ğŸ’¡ è¶‹åŠ¿å»ºè®®: æŒæœ‰å¤šå¤´ä½†è¶‹åŠ¿å·²è½¬ä¸ºä¸‹è·Œï¼Œå»ºè®®è¯„ä¼°æ˜¯å¦æå‰ç¦»åœº
```

**å…³é”®ç‰¹ç‚¹**ï¼š

- âœ… ä¿¡æ¯å®Œæ•´ä½†ä¸å¼ºåˆ¶ï¼šAIå¯ä»¥å‚è€ƒä½†ä¸å¿…ä¸¥æ ¼éµå®ˆ
- âœ… ä¸é£æ§ä¿¡æ¯å¹¶åˆ—ï¼šä¸å¹²æ‰°ç°æœ‰çš„R-Multipleã€æ­¢æŸç­‰æ ¸å¿ƒæŒ‡æ ‡
- âœ… æ¸…æ™°çš„åè½¬ä¿¡å·ï¼šæ˜ç¡®æ ‡æ³¨"å…¥åœºæ—¶vsç°åœ¨"çš„çŠ¶æ€å¯¹æ¯”

#### ç¬¬äºŒå±‚ï¼šå†³ç­–æµç¨‹è°ƒæ•´ï¼ˆå…³é”®ï¼‰

**ç›®æ ‡**ï¼šé‡æ–°ç»„ç»‡æ­¥éª¤3ï¼Œæ˜ç¡®è¶‹åŠ¿ä¿¡æ¯çš„ä½¿ç”¨æ–¹å¼

**åŸæœ‰æµç¨‹**ï¼ˆæœ‰æ­§ä¹‰ï¼‰ï¼š

```text
æ­¥éª¤3ï¼šæ£€æŸ¥å¹³ä»“è§¦å‘ï¼ˆæœ€åæ£€æŸ¥ï¼‰
â”œâ”€ å³°å€¼å›æ’¤ â‰¥ 25-35% â†’ å±é™©ä¿¡å·ï¼Œè€ƒè™‘å¹³ä»“
â”œâ”€ è¶‹åŠ¿æ˜ç¡®åè½¬ï¼ˆ3+æ—¶é—´æ¡†æ¶ï¼‰ â†’ è€ƒè™‘å¹³ä»“  âš ï¸ å¦‚ä½•åˆ¤æ–­ï¼Ÿ
â”œâ”€ æŒä»“æ—¶é—´ â‰¥ 36å°æ—¶ â†’ å¼ºåˆ¶å¹³ä»“
```

**ä¼˜åŒ–åæµç¨‹**ï¼ˆæ¸…æ™°æ˜ç¡®ï¼‰ï¼š

```text
æ­¥éª¤3ï¼šç»¼åˆè¯„ä¼°å¹³ä»“æ—¶æœºï¼ˆè¾…åŠ©å†³ç­–ï¼Œéå¼ºåˆ¶ï¼‰

âš ï¸ æ³¨æ„ï¼šæ­¥éª¤3æ˜¯è¾…åŠ©æ€§å†³ç­–ï¼Œä¸ä¼šä¸æ­¥éª¤1-2å†²çª
- æ­¥éª¤1ï¼ˆåˆ†æ‰¹æ­¢ç›ˆï¼‰å’Œæ­¥éª¤2ï¼ˆç§»åŠ¨æ­¢æŸï¼‰æ˜¯ç¨‹åºåŒ–æ‰§è¡Œï¼Œä¼˜å…ˆçº§æœ€é«˜
- æ­¥éª¤3æä¾›AIä¸»åŠ¨å¹³ä»“çš„åˆ¤æ–­ä¾æ®ï¼Œæ˜¯"é”¦ä¸Šæ·»èŠ±"è€Œé"å¿…é¡»æ‰§è¡Œ"

â”œâ”€ ã€ç¡¬æ€§è§„åˆ™ã€‘æŒä»“æ—¶é—´ â‰¥ 36å°æ—¶ â†’ å¼ºåˆ¶å…¨éƒ¨å¹³ä»“ï¼ˆæ— ä¾‹å¤–ï¼‰
â”‚   
â”œâ”€ ã€å±é™©ä¿¡å·ã€‘ä»¥ä¸‹æƒ…å†µè€ƒè™‘ä¸»åŠ¨å¹³ä»“ï¼ˆAIåˆ¤æ–­ï¼‰ï¼š
â”‚   
â”‚   (a) å³°å€¼å›æ’¤ä¿æŠ¤
â”‚   â”œâ”€ è§¦å‘æ¡ä»¶ï¼šå³°å€¼å›æ’¤ â‰¥ 25-35%ï¼ˆæ ¹æ®ç­–ç•¥ï¼‰
â”‚   â”œâ”€ å«ä¹‰ï¼šåˆ©æ¶¦ä¸¥é‡å›åï¼Œè¯´æ˜è¶‹åŠ¿å·²ç»èµ°å¼±
â”‚   â””â”€ å»ºè®®ï¼šç«‹å³å…¨éƒ¨å¹³ä»“ï¼Œä¿æŠ¤å‰©ä½™åˆ©æ¶¦
â”‚   
â”‚   (b) è¶‹åŠ¿åè½¬è¯†åˆ«ï¼ˆæ–°å¢ï¼šåŸºäºå¸‚åœºçŠ¶æ€åˆ†æï¼‰
â”‚   â”œâ”€ ä¿¡æ¯æ¥æºï¼šæŒä»“ä¿¡æ¯ä¸­çš„"ğŸ“Š å¸‚åœºè¶‹åŠ¿åˆ†æ"éƒ¨åˆ†
â”‚   â”œâ”€ è§¦å‘æ¡ä»¶ï¼š
â”‚   â”‚   â€¢ æŒä»“æ–¹å‘ = longï¼Œä½†å¸‚åœºçŠ¶æ€ = downtrend_* (trending_down)
â”‚   â”‚   â€¢ æˆ–ï¼šæŒä»“æ–¹å‘ = shortï¼Œä½†å¸‚åœºçŠ¶æ€ = uptrend_* (trending_up)
â”‚   â”‚   â€¢ ä¸”ï¼šåè½¬ä¿¡å· = æ˜¯ï¼Œå¤šæ—¶é—´æ¡†æ¶ä¸€è‡´æ€§ â‰¥ 70%
â”‚   â”œâ”€ å†³ç­–åŸåˆ™ï¼š
â”‚   â”‚   â€¢ å¦‚æœæŒä»“ç›ˆåˆ© < 0%ï¼šè¶‹åŠ¿åè½¬ + äºæŸ = é«˜é£é™©ï¼Œå»ºè®®å¹³ä»“
â”‚   â”‚   â€¢ å¦‚æœæŒä»“ç›ˆåˆ© 0-15%ï¼šæ ¹æ®åè½¬å¼ºåº¦å’Œç½®ä¿¡åº¦åˆ¤æ–­
â”‚   â”‚   â€¢ å¦‚æœæŒä»“ç›ˆåˆ© > 15%ï¼šå¯èƒ½æ˜¯æ­£å¸¸å›è°ƒï¼Œå¯æš‚æ—¶è§‚æœ›
â”‚   â””â”€ æ³¨æ„äº‹é¡¹ï¼š
â”‚       â€¢ ä¸è¦å› ä¸º"å°å¹…äºæŸ+è¶‹åŠ¿åè½¬"å°±ææ…Œå¹³ä»“ï¼ˆæ­¢æŸå•ä¼šä¿æŠ¤ï¼‰
â”‚       â€¢ ä½†å¦‚æœ"è¶‹åŠ¿æ˜ç¡®åè½¬+äºæŸåŠ æ·±"ï¼Œåº”ä¸»åŠ¨ç¦»åœº
â”‚       â€¢ ç›ˆåˆ©æŒä»“é‡åˆ°åè½¬ï¼šä¼˜å…ˆè€ƒè™‘åˆ†æ‰¹æ­¢ç›ˆï¼Œè€Œéå…¨éƒ¨å¹³ä»“
â”‚   
â”‚   (c) å…¶ä»–å±é™©ä¿¡å·
â”‚   â”œâ”€ æ³¢åŠ¨ç‡çªç„¶æ”¾å¤§ï¼ˆATRæ¯”ç‡ > 2.0ï¼‰
â”‚   â”œâ”€ æµåŠ¨æ€§æ¯ç«­ï¼ˆæˆäº¤é‡å¼‚å¸¸ä¸‹é™ï¼‰
â”‚   â””â”€ æŠ€æœ¯å½¢æ€ç ´åï¼ˆå…³é”®æ”¯æ’‘/é˜»åŠ›ä½å¤±å®ˆï¼‰
â”‚
â””â”€ ã€å†³ç­–å†²çªå¤„ç†ã€‘
    â€¢ å¦‚æœæ­¥éª¤1å·²æ‰§è¡Œåˆ†æ‰¹æ­¢ç›ˆ â†’ æœ¬å‘¨æœŸä¸å†è€ƒè™‘æ­¥éª¤3çš„å…¨éƒ¨å¹³ä»“
    â€¢ å¦‚æœæ­¥éª¤1æç¤ºå¯æ‰§è¡Œä½†æœªæ‰§è¡Œ â†’ ä¼˜å…ˆæ‰§è¡Œåˆ†æ‰¹æ­¢ç›ˆï¼Œæ¨è¿Ÿå…¨éƒ¨å¹³ä»“åˆ¤æ–­
    â€¢ åªæœ‰åœ¨"æ˜ç¡®çš„å±é™©ä¿¡å· + æ— åˆ†æ‰¹æ­¢ç›ˆæœºä¼š"æ—¶ï¼Œæ‰è€ƒè™‘å…¨éƒ¨å¹³ä»“
```

**å…³é”®æ”¹è¿›**ï¼š

1. âœ… **æ˜ç¡®ä¼˜å…ˆçº§**ï¼š36å°æ—¶ > åˆ†æ‰¹æ­¢ç›ˆ > è¶‹åŠ¿åè½¬åˆ¤æ–­
2. âœ… **å†³ç­–åˆ†å±‚**ï¼šç¡¬æ€§è§„åˆ™ vs è¾…åŠ©åˆ¤æ–­ï¼Œç•Œé™æ¸…æ™°
3. âœ… **å†²çªå¤„ç†**ï¼šæ˜ç¡®è¶‹åŠ¿åè½¬ä¸åº”å¹²æ‰°åˆ†æ‰¹æ­¢ç›ˆç­–ç•¥
4. âœ… **åˆ¤æ–­æ ‡å‡†**ï¼šåŸºäºç›ˆäºçŠ¶æ€ + åè½¬å¼ºåº¦ï¼Œè€Œéä¸€åˆ€åˆ‡

#### ç¬¬ä¸‰å±‚ï¼šå·¥å…·å±‚å®ç°ï¼ˆæŠ€æœ¯ï¼‰

**ä¸éœ€è¦æ–°å¢å·¥å…·**ï¼ŒåŸå› ï¼š

1. `analyzeMultipleMarketStates()` å·²å­˜åœ¨ï¼Œå¯ç›´æ¥è°ƒç”¨
2. åœ¨ `generateTradingPrompt()` å†…éƒ¨è°ƒç”¨ï¼Œæ— éœ€æš´éœ²ç»™AI
3. ç®€åŒ–ç³»ç»Ÿå¤æ‚åº¦ï¼Œé¿å…å·¥å…·çˆ†ç‚¸

**å®æ–½ä½ç½®**ï¼š

- æ–‡ä»¶ï¼š`src/agents/tradingAgent.ts`
- å‡½æ•°ï¼š`generateTradingPrompt()`
- ä½ç½®ï¼šç”ŸæˆæŒä»“ä¿¡æ¯çš„å¾ªç¯ä¸­

**ä¼ªä»£ç **ï¼š

```typescript
// åœ¨ç”ŸæˆæŒä»“ä¿¡æ¯å‰ï¼Œæ‰¹é‡åˆ†æå¸‚åœºçŠ¶æ€
const positionSymbols = positions.map(p => p.symbol);
const marketStates = await analyzeMultipleMarketStates(positionSymbols);

// åœ¨æŒä»“ä¿¡æ¯å¾ªç¯ä¸­
for (const pos of positions) {
  // ...existing position info...
  
  // è¿½åŠ å¸‚åœºè¶‹åŠ¿åˆ†æ
  const state = marketStates.get(pos.symbol);
  if (state) {
    const reversalSignal = detectReversalSignal(pos.side, state, pos.entry_state);
    prompt += `â”œâ”€ ğŸ“Š å¸‚åœºè¶‹åŠ¿åˆ†æï¼ˆä¾›å†³ç­–å‚è€ƒï¼‰ï¼š\n`;
    prompt += `â”‚   â€¢ å½“å‰çŠ¶æ€: ${state.state}\n`;
    prompt += `â”‚   â€¢ è¶‹åŠ¿å¼ºåº¦: ${state.trendStrength}\n`;
    prompt += `â”‚   â€¢ åè½¬ä¿¡å·: ${reversalSignal ? 'âš ï¸ æ˜¯' : 'å¦'}\n`;
    // ...more details...
  }
}
```

### æ–¹æ¡ˆä¼˜åŠ¿

| ç»´åº¦ | ä¼˜åŠ¿ | è¯´æ˜ |
|------|------|------|
| **å®‰å…¨æ€§** | â­â­â­â­â­ | ä¸æ”¹å˜ç°æœ‰é£æ§è§„åˆ™ï¼Œé›¶å†²çªé£é™© |
| **ä¸€è‡´æ€§** | â­â­â­â­â­ | æŒä»“ç®¡ç†ä¸å¼€ä»“å†³ç­–äº«æœ‰åŒç­‰è´¨é‡çš„åˆ†æ |
| **çµæ´»æ€§** | â­â­â­â­â­ | AIå¯å‚è€ƒä½†ä¸å¼ºåˆ¶ï¼Œä¿ç•™åˆ¤æ–­è‡ªä¸»æƒ |
| **å¯è¿½æº¯** | â­â­â­â­ | è¶‹åŠ¿å˜åŒ–è®°å½•åœ¨promptä¸­ï¼Œä¾¿äºåˆ†æ |
| **å®ç°éš¾åº¦** | â­â­â­â­ | å¤ç”¨ç°æœ‰å‡½æ•°ï¼Œæ— éœ€æ–°å¢å·¥å…· |

---

## å®æ–½è®¡åˆ’ï¼ˆç²¾ç®€ç‰ˆï¼‰

### Phase 1ï¼šæ•°æ®å±‚å®ç°ï¼ˆ1.5å°æ—¶ï¼‰

**ä»»åŠ¡1.1**ï¼šåœ¨ `generateTradingPrompt()` ä¸­è°ƒç”¨å¸‚åœºçŠ¶æ€åˆ†æ

- ä½ç½®ï¼š`src/agents/tradingAgent.ts` çº¦1100è¡Œé™„è¿‘ï¼ˆæŒä»“ä¿¡æ¯ç”Ÿæˆéƒ¨åˆ†ï¼‰
- æ·»åŠ ä»£ç ï¼š

  ```typescript
  // åœ¨æŒä»“ä¿¡æ¯ç”Ÿæˆå‰ï¼Œæ‰¹é‡åˆ†æå¸‚åœºçŠ¶æ€
  const positionSymbols = positions.map(p => p.symbol);
  const marketStates = await analyzeMultipleMarketStates(positionSymbols);
  ```

**ä»»åŠ¡1.2**ï¼šåœ¨æŒä»“ä¿¡æ¯ä¸­è¿½åŠ å¸‚åœºè¶‹åŠ¿åˆ†æ

- åœ¨æ¯ä¸ªæŒä»“çš„å±•ç¤ºå¾ªç¯ä¸­ï¼Œæ·»åŠ è¶‹åŠ¿ä¿¡æ¯è¾“å‡º
- æ£€æµ‹åè½¬ä¿¡å·ï¼ˆå¯¹æ¯”å…¥åœºæ—¶å¸‚åœºçŠ¶æ€ vs å½“å‰å¸‚åœºçŠ¶æ€ï¼‰
- æ ¼å¼åŒ–è¾“å‡ºï¼Œä¿æŒpromptå¯è¯»æ€§

**ä»»åŠ¡1.3**ï¼šå¤„ç†å…¥åœºæ—¶å¸‚åœºçŠ¶æ€è®°å½•

- åœ¨ `openPosition` å·¥å…·ä¸­ï¼Œè®°å½•å¼€ä»“æ—¶çš„å¸‚åœºçŠ¶æ€ï¼ˆå­˜å…¥positionsè¡¨çš„metadataå­—æ®µï¼‰
- ç”¨äºåç»­å¯¹æ¯”åˆ¤æ–­æ˜¯å¦å‘ç”Ÿè¶‹åŠ¿åè½¬

### Phase 2ï¼šæç¤ºè¯ä¼˜åŒ–ï¼ˆ1å°æ—¶ï¼‰

**ä»»åŠ¡2.1**ï¼šé‡å†™æ­¥éª¤3çš„å†³ç­–è¯´æ˜

- æ˜ç¡®"è¾…åŠ©å†³ç­–"å®šä½
- æ·»åŠ å†³ç­–å†²çªå¤„ç†è§„åˆ™
- æä¾›è¶‹åŠ¿åè½¬çš„åˆ¤æ–­ç¤ºä¾‹

**ä»»åŠ¡2.2**ï¼šæ·»åŠ å†³ç­–æ¡ˆä¾‹

- æ­£ç¡®æ¡ˆä¾‹ï¼šè¶‹åŠ¿åè½¬ä½†ç›ˆåˆ©å……è¶³ï¼Œåˆ†æ‰¹æ­¢ç›ˆè€Œéå…¨éƒ¨å¹³ä»“
- é”™è¯¯æ¡ˆä¾‹ï¼šç›²ç›®è¿½éšè¶‹åŠ¿ä¿¡å·ï¼Œç ´ååˆ†æ‰¹æ­¢ç›ˆç­–ç•¥
- è¾¹ç•Œæ¡ˆä¾‹ï¼šè¶‹åŠ¿åè½¬+äºæŸåŠ æ·±ï¼Œå¦‚ä½•æƒè¡¡

### Phase 3ï¼šæµ‹è¯•éªŒè¯ï¼ˆ1å°æ—¶ï¼‰

**ä»»åŠ¡3.1**ï¼šå•å…ƒæµ‹è¯•

- æµ‹è¯•å¸‚åœºçŠ¶æ€åˆ†ææ˜¯å¦æ­£å¸¸
- æµ‹è¯•åè½¬ä¿¡å·æ£€æµ‹é€»è¾‘
- éªŒè¯promptç”Ÿæˆæ€§èƒ½

**ä»»åŠ¡3.2**ï¼šé›†æˆæµ‹è¯•

- æ¨¡æ‹ŸæŒä»“åœ¨è¶‹åŠ¿åè½¬æ—¶çš„ä¿¡æ¯å±•ç¤º
- æ£€æŸ¥AIæ˜¯å¦èƒ½ç†è§£è¶‹åŠ¿ä¿¡æ¯
- éªŒè¯å†³ç­–æ˜¯å¦åˆç†ï¼ˆä¸åº”ç ´ååˆ†æ‰¹æ­¢ç›ˆï¼‰

**ä»»åŠ¡3.3**ï¼šå›å½’æµ‹è¯•

- è¿è¡Œ `test-integration-phase4.ts`
- ç¡®ä¿ç°æœ‰åŠŸèƒ½ä¸å—å½±å“

### æ€»æ—¶é—´ï¼šçº¦3.5å°æ—¶

---

## ä»£ç æ”¹åŠ¨é¢„è§ˆ

### æ”¹åŠ¨1ï¼šæŒä»“ä¿¡æ¯ç”Ÿæˆå¢å¼º

**æ–‡ä»¶**ï¼š`src/agents/tradingAgent.ts`

**ä½ç½®**ï¼š`generateTradingPrompt()` å‡½æ•°ä¸­çš„æŒä»“ä¿¡æ¯ç”Ÿæˆéƒ¨åˆ†

**æ”¹åŠ¨å†…å®¹**ï¼š

```typescript
// åœ¨æŒä»“ä¿¡æ¯ç”Ÿæˆå‰ï¼ˆçº¦1100è¡Œé™„è¿‘ï¼‰
if (positions.length > 0) {
  prompt += `ä»¥ä¸‹æ˜¯æ‚¨å½“å‰çš„æŒä»“ä¿¡æ¯...\n\n`;
  
  // ğŸ†• æ‰¹é‡åˆ†ææŒä»“å¸ç§çš„å¸‚åœºçŠ¶æ€
  const positionSymbols = positions.map(p => p.symbol);
  let marketStates: Map<string, MarketStateAnalysis> = new Map();
  try {
    marketStates = await analyzeMultipleMarketStates(positionSymbols);
  } catch (error) {
    logger.warn(`å¸‚åœºçŠ¶æ€åˆ†æå¤±è´¥: ${error}`);
  }
  
  for (const pos of positions) {
    // ...existing position info...
    
    // ğŸ†• è¿½åŠ å¸‚åœºè¶‹åŠ¿åˆ†æ
    const state = marketStates.get(pos.symbol);
    if (state) {
      // æ£€æµ‹è¶‹åŠ¿åè½¬
      const entryState = pos.metadata?.marketState; // éœ€è¦åœ¨å¼€ä»“æ—¶è®°å½•
      const reversalSignal = detectReversalSignal(pos.side, state, entryState);
      
      prompt += `â”œâ”€ ğŸ“Š å¸‚åœºè¶‹åŠ¿åˆ†æï¼ˆä¾›å†³ç­–å‚è€ƒï¼‰ï¼š\n`;
      prompt += `â”‚   â€¢ å½“å‰çŠ¶æ€: ${state.state} (${getStateDescription(state.state)})\n`;
      prompt += `â”‚   â€¢ è¶‹åŠ¿å¼ºåº¦: ${state.trendStrength}\n`;
      prompt += `â”‚   â€¢ åŠ¨é‡çŠ¶æ€: ${state.momentumState}\n`;
      prompt += `â”‚   â€¢ åè½¬ä¿¡å·: ${reversalSignal.detected ? 'âš ï¸ æ˜¯' : 'å¦'}`;
      if (reversalSignal.detected) {
        prompt += ` (${reversalSignal.confidence}%ç½®ä¿¡åº¦, ${reversalSignal.timeframes}ä¸ªæ—¶é—´æ¡†æ¶ç¡®è®¤)\n`;
        prompt += `â”‚   â€¢ è¶‹åŠ¿å˜åŒ–: ${entryState || 'æœªçŸ¥'} â†’ ${state.state}\n`;
      } else {
        prompt += `\n`;
      }
      prompt += `â”‚   â€¢ å¤šæ—¶é—´æ¡†æ¶ä¸€è‡´æ€§: ${Math.round(state.timeframeAlignment.alignmentScore * 100)}%\n`;
      prompt += `â”‚   â€¢ åˆ†æç½®ä¿¡åº¦: ${Math.round(state.confidence * 100)}%\n`;
      
      // æ ¹æ®åè½¬ä¿¡å·æä¾›å»ºè®®
      if (reversalSignal.detected) {
        const recommendation = getReversalRecommendation(pos, state, reversalSignal);
        prompt += `â””â”€ ğŸ’¡ è¶‹åŠ¿å»ºè®®: ${recommendation}\n`;
      }
    }
    prompt += `\n`;
  }
}
```

### æ”¹åŠ¨2ï¼šè¾…åŠ©å‡½æ•°

**æ–°å¢å‡½æ•°**ï¼š

```typescript
/**
 * æ£€æµ‹è¶‹åŠ¿åè½¬ä¿¡å·
 */
function detectReversalSignal(
  positionSide: 'long' | 'short',
  currentState: MarketStateAnalysis,
  entryState?: string
): { detected: boolean; confidence: number; timeframes: number } {
  if (!entryState) return { detected: false, confidence: 0, timeframes: 0 };
  
  // åˆ¤æ–­æ˜¯å¦å‘ç”Ÿè¶‹åŠ¿åè½¬
  const isLong = positionSide === 'long';
  const wasUptrend = entryState.startsWith('uptrend');
  const wasDowntrend = entryState.startsWith('downtrend');
  const nowUptrend = currentState.state.startsWith('uptrend');
  const nowDowntrend = currentState.state.startsWith('downtrend');
  
  // å¤šå¤´æŒä»“ï¼šå…¥åœºæ—¶ä¸Šæ¶¨â†’ç°åœ¨ä¸‹è·Œ
  if (isLong && wasUptrend && nowDowntrend) {
    return {
      detected: true,
      confidence: Math.round(currentState.confidence * 100),
      timeframes: currentState.timeframeAlignment.is15mAnd1hAligned ? 3 : 2
    };
  }
  
  // ç©ºå¤´æŒä»“ï¼šå…¥åœºæ—¶ä¸‹è·Œâ†’ç°åœ¨ä¸Šæ¶¨
  if (!isLong && wasDowntrend && nowUptrend) {
    return {
      detected: true,
      confidence: Math.round(currentState.confidence * 100),
      timeframes: currentState.timeframeAlignment.is15mAnd1hAligned ? 3 : 2
    };
  }
  
  return { detected: false, confidence: 0, timeframes: 0 };
}

/**
 * è·å–è¶‹åŠ¿åè½¬åçš„æ“ä½œå»ºè®®
 */
function getReversalRecommendation(
  position: any,
  state: MarketStateAnalysis,
  reversal: { detected: boolean; confidence: number; timeframes: number }
): string {
  const pnlPercent = position.unrealized_pnl_percent || 0;
  const side = position.side === 'long' ? 'å¤šå¤´' : 'ç©ºå¤´';
  const trendDir = state.trendStrength === 'trending_up' ? 'ä¸Šæ¶¨' : 
                   state.trendStrength === 'trending_down' ? 'ä¸‹è·Œ' : 'éœ‡è¡';
  
  if (pnlPercent < -5) {
    return `æŒæœ‰${side}ä½†è¶‹åŠ¿å·²è½¬ä¸º${trendDir}ï¼Œä¸”äºæŸ${Math.abs(pnlPercent).toFixed(1)}%ï¼Œå»ºè®®è¯„ä¼°æ˜¯å¦æå‰ç¦»åœº`;
  } else if (pnlPercent < 5) {
    return `æŒæœ‰${side}ä½†è¶‹åŠ¿å·²è½¬ä¸º${trendDir}ï¼Œå½“å‰å¾®åˆ©/å¾®äºï¼Œå»ºè®®å…³æ³¨æ˜¯å¦éœ€è¦ç¦»åœº`;
  } else if (pnlPercent < 15) {
    return `æŒæœ‰${side}ä½†è¶‹åŠ¿å·²è½¬ä¸º${trendDir}ï¼Œç›ˆåˆ©${pnlPercent.toFixed(1)}%ï¼Œå»ºè®®ä¼˜å…ˆè€ƒè™‘åˆ†æ‰¹æ­¢ç›ˆè€Œéå…¨éƒ¨å¹³ä»“`;
  } else {
    return `æŒæœ‰${side}ä½†è¶‹åŠ¿å·²è½¬ä¸º${trendDir}ï¼Œç›ˆåˆ©${pnlPercent.toFixed(1)}%ï¼Œå¯èƒ½æ˜¯æ­£å¸¸å›è°ƒï¼Œå¯æš‚æ—¶è§‚æœ›`;
  }
}

/**
 * è·å–å¸‚åœºçŠ¶æ€çš„ä¸­æ–‡æè¿°
 */
function getStateDescription(state: string): string {
  const descriptions: Record<string, string> = {
    'uptrend_oversold': 'ä¸Šæ¶¨è¶‹åŠ¿ä¸­çš„è¶…å–å›è°ƒ',
    'uptrend_overbought': 'ä¸Šæ¶¨è¶‹åŠ¿ä¸­çš„è¶…ä¹°',
    'downtrend_overbought': 'ä¸‹è·Œè¶‹åŠ¿ä¸­çš„è¶…ä¹°åå¼¹',
    'downtrend_oversold': 'ä¸‹è·Œè¶‹åŠ¿ä¸­çš„è¶…å–',
    'uptrend_continuation': 'ä¸Šæ¶¨è¶‹åŠ¿å»¶ç»­',
    'downtrend_continuation': 'ä¸‹è·Œè¶‹åŠ¿å»¶ç»­',
    'ranging_oversold': 'éœ‡è¡å¸‚è¶…å–',
    'ranging_overbought': 'éœ‡è¡å¸‚è¶…ä¹°',
    'ranging_neutral': 'éœ‡è¡å¸‚ä¸­æ€§',
    'no_clear_signal': 'æ— æ˜ç¡®ä¿¡å·'
  };
  return descriptions[state] || state;
}
```

### æ”¹åŠ¨3ï¼šå¼€ä»“æ—¶è®°å½•å¸‚åœºçŠ¶æ€

**æ–‡ä»¶**ï¼š`src/tools/trading/tradeExecution.ts`

**ä½ç½®**ï¼š`openPositionTool.execute()` å‡½æ•°ä¸­

**æ”¹åŠ¨å†…å®¹**ï¼š

```typescript
// åœ¨æˆåŠŸå¼€ä»“åï¼Œè®°å½•å¸‚åœºçŠ¶æ€ï¼ˆçº¦900è¡Œé™„è¿‘ï¼‰
try {
  // ...existing open position logic...
  
  // ğŸ†• åˆ†æå¹¶è®°å½•å¼€ä»“æ—¶çš„å¸‚åœºçŠ¶æ€
  let entryMarketState: string | undefined;
  try {
    const stateAnalysis = await analyzeMarketState(symbol);
    entryMarketState = stateAnalysis.state;
  } catch (e) {
    logger.warn(`æ— æ³•åˆ†æå¼€ä»“æ—¶çš„å¸‚åœºçŠ¶æ€: ${e}`);
  }
  
  // æ’å…¥positionsè®°å½•æ—¶ï¼ŒåŒ…å«å¸‚åœºçŠ¶æ€
  await dbClient.execute({
    sql: `INSERT INTO positions (..., metadata) VALUES (..., ?)`,
    args: [..., JSON.stringify({ 
      marketState: entryMarketState,
      entryTime: Date.now()
    })]
  });
  
  // ...existing return logic...
} catch (error) {
  // ...
}
```

### æ”¹åŠ¨4ï¼šæç¤ºè¯æ­¥éª¤3ä¼˜åŒ–

**æ–‡ä»¶**ï¼š`src/agents/tradingAgent.ts`

**ä½ç½®**ï¼š`generateTradingPrompt()` å‡½æ•°ä¸­çš„æ­¥éª¤3æè¿°

**æ”¹åŠ¨å†…å®¹**ï¼ˆè§å‰æ–‡"ç¬¬äºŒå±‚ï¼šå†³ç­–æµç¨‹è°ƒæ•´"éƒ¨åˆ†çš„å®Œæ•´æ–‡æœ¬ï¼‰

---

## é£é™©è¯„ä¼°ä¸ç¼“è§£

### é£é™©1ï¼šå¸‚åœºçŠ¶æ€åˆ†ææ€§èƒ½

**é£é™©ç­‰çº§**ï¼šä½

**æè¿°**ï¼šæ¯æ¬¡ç”Ÿæˆpromptéƒ½è¦åˆ†ææŒä»“çš„å¸‚åœºçŠ¶æ€ï¼Œå¯èƒ½å¢åŠ å»¶è¿Ÿ

**ç¼“è§£æªæ–½**ï¼š

- `analyzeMultipleMarketStates()` ä½¿ç”¨å¹¶å‘åˆ†æï¼Œæ€§èƒ½å·²éªŒè¯
- é€šå¸¸æŒä»“æ•°é‡ â‰¤ 3ä¸ªï¼Œåˆ†ææ—¶é—´ < 2ç§’
- å¦‚æœè¶…æ—¶ï¼Œcatchåç»§ç»­ï¼Œä¸å½±å“ä¸»æµç¨‹

### é£é™©2ï¼šPrompté•¿åº¦å¢åŠ 

**é£é™©ç­‰çº§**ï¼šä½

**æè¿°**ï¼šæ¯ä¸ªæŒä»“å¢åŠ çº¦100 tokensçš„è¶‹åŠ¿ä¿¡æ¯

**å½±å“è¯„ä¼°**ï¼š

- 3ä¸ªæŒä»“ Ã— 100 tokens = 300 tokens
- ç›¸å¯¹äºæ•´ä¸ªpromptï¼ˆçº¦5000-8000 tokensï¼‰ï¼Œå¢å¹… < 5%
- åœ¨GPT-4çš„128kä¸Šä¸‹æ–‡çª—å£ä¸­ï¼Œå®Œå…¨å¯æ¥å—

### é£é™©3ï¼šAIç†è§£åå·®

**é£é™©ç­‰çº§**ï¼šä¸­

**æè¿°**ï¼šAIå¯èƒ½è¿‡åº¦ä¾èµ–è¶‹åŠ¿ä¿¡å·ï¼Œå¿½ç•¥åˆ†æ‰¹æ­¢ç›ˆ

**ç¼“è§£æªæ–½**ï¼š

- åœ¨promptä¸­æ˜ç¡®"è¾…åŠ©å†³ç­–"å®šä½
- æä¾›æ­£ç¡®å’Œé”™è¯¯æ¡ˆä¾‹ï¼Œå¼ºè°ƒå†³ç­–ä¼˜å…ˆçº§
- åœ¨æ­¥éª¤3ä¸­å¼ºè°ƒ"ä¸åº”ä¸æ­¥éª¤1-2å†²çª"

### é£é™©4ï¼šæ•°æ®åº“schemaå˜æ›´

**é£é™©ç­‰çº§**ï¼šä½

**æè¿°**ï¼špositionsè¡¨çš„metadataå­—æ®µå¯èƒ½ä¸å­˜åœ¨

**ç¼“è§£æªæ–½**ï¼š

- æ£€æŸ¥ç°æœ‰schemaï¼Œå¦‚ä¸å­˜åœ¨åˆ™æ·»åŠ 
- ä½¿ç”¨JSONæ ¼å¼å­˜å‚¨ï¼Œçµæ´»æ‰©å±•
- ä»£ç ä¸­å¢åŠ å®¹é”™å¤„ç†

---

## æµ‹è¯•è®¡åˆ’

### æµ‹è¯•1ï¼šå¸‚åœºçŠ¶æ€åˆ†æå‡†ç¡®æ€§

**æµ‹è¯•è„šæœ¬**ï¼š`scripts/test-position-market-analysis.ts`

```typescript
// æµ‹è¯•æŒä»“å¸‚åœºçŠ¶æ€åˆ†æ
const symbols = ['BTC', 'ETH', 'SOL'];
const states = await analyzeMultipleMarketStates(symbols);

for (const [symbol, state] of states) {
  console.log(`${symbol}: ${state.state} (${state.trendStrength})`);
}
```

### æµ‹è¯•2ï¼šåè½¬ä¿¡å·æ£€æµ‹

**æµ‹è¯•åœºæ™¯**ï¼š

1. å…¥åœºæ—¶ `uptrend_oversold`ï¼Œç°åœ¨ `downtrend_continuation` â†’ åº”æ£€æµ‹åˆ°åè½¬
2. å…¥åœºæ—¶ `uptrend_oversold`ï¼Œç°åœ¨ `uptrend_overbought` â†’ ä¸åº”æ£€æµ‹åˆ°åè½¬
3. å…¥åœºæ—¶æœªè®°å½•ï¼Œç°åœ¨ä»»æ„çŠ¶æ€ â†’ ä¸åº”æ£€æµ‹åˆ°åè½¬

### æµ‹è¯•3ï¼šPromptç”Ÿæˆæ€§èƒ½

**æµ‹è¯•æ–¹æ³•**ï¼š

- åˆ›å»º3ä¸ªæ¨¡æ‹ŸæŒä»“
- è®¡æ—¶ `generateTradingPrompt()` æ‰§è¡Œæ—¶é—´
- ç›®æ ‡ï¼š< 5ç§’ï¼ˆå«å¸‚åœºçŠ¶æ€åˆ†æï¼‰

### æµ‹è¯•4ï¼šAIå†³ç­–è´¨é‡

**æµ‹è¯•æ–¹æ³•**ï¼š

- ä½¿ç”¨çœŸå®å¸‚åœºæ•°æ®ç”Ÿæˆprompt
- è§‚å¯ŸAIæ˜¯å¦æ­£ç¡®ç†è§£è¶‹åŠ¿ä¿¡æ¯
- éªŒè¯AIå†³ç­–æ˜¯å¦ç¬¦åˆä¼˜å…ˆçº§è§„åˆ™

---

## æˆåŠŸæ ‡å‡†

### åŠŸèƒ½æ€§æ ‡å‡†

- [ ] æŒä»“ä¿¡æ¯ä¸­æ˜¾ç¤ºå®Œæ•´çš„å¸‚åœºè¶‹åŠ¿åˆ†æ
- [ ] åè½¬ä¿¡å·å‡†ç¡®è¯†åˆ«ï¼ˆå¯¹æ¯”å…¥åœºvså½“å‰çŠ¶æ€ï¼‰
- [ ] Promptç”Ÿæˆæ—¶é—´å¢åŠ  < 2ç§’
- [ ] ä¸ç ´åç°æœ‰çš„åˆ†æ‰¹æ­¢ç›ˆã€ç§»åŠ¨æ­¢æŸé€»è¾‘

### è´¨é‡æ ‡å‡†

- [ ] ä»£ç å¤æ‚åº¦ï¼šå•ä¸ªå‡½æ•° < 100è¡Œ
- [ ] æµ‹è¯•è¦†ç›–ç‡ï¼šæ ¸å¿ƒå‡½æ•° > 80%
- [ ] é”™è¯¯å¤„ç†ï¼šæ‰€æœ‰å¤–éƒ¨è°ƒç”¨éƒ½æœ‰try-catch
- [ ] æ—¥å¿—å®Œæ•´ï¼šå…³é”®æ­¥éª¤æœ‰infoæ—¥å¿—

### ä¸šåŠ¡æ ‡å‡†

- [ ] AIå†³ç­–è´¨é‡ï¼šæŒä»“ç®¡ç†å‡†ç¡®æ€§æå‡ > 20%
- [ ] è¶‹åŠ¿åè½¬è¯†åˆ«ï¼šå»¶è¿Ÿ < 1ä¸ªäº¤æ˜“å‘¨æœŸï¼ˆ5-15åˆ†é’Ÿï¼‰
- [ ] ç”¨æˆ·ä½“éªŒï¼šå‡å°‘è¢«åŠ¨æ­¢æŸï¼Œå¢åŠ ä¸»åŠ¨ç¦»åœº
- [ ] ç³»ç»Ÿç¨³å®šæ€§ï¼šè¿è¡Œ7å¤©æ— å´©æºƒ

---

## é™„å½•

### A. å¸‚åœºçŠ¶æ€è¯´æ˜

| çŠ¶æ€ä»£ç  | ä¸­æ–‡æè¿° | é€‚åˆæ–¹å‘ | ä¿¡å·å¼ºåº¦ |
|---------|---------|---------|---------|
| uptrend_oversold | ä¸Šæ¶¨è¶‹åŠ¿ä¸­çš„è¶…å–å›è°ƒ | åšå¤š | â­â­â­â­â­ |
| uptrend_overbought | ä¸Šæ¶¨è¶‹åŠ¿ä¸­çš„è¶…ä¹° | è§‚æœ›/åšç©º | â­â­â­ |
| downtrend_overbought | ä¸‹è·Œè¶‹åŠ¿ä¸­çš„è¶…ä¹°åå¼¹ | åšç©º | â­â­â­â­â­ |
| downtrend_oversold | ä¸‹è·Œè¶‹åŠ¿ä¸­çš„è¶…å– | è§‚æœ›/åšå¤š | â­â­â­ |
| uptrend_continuation | ä¸Šæ¶¨è¶‹åŠ¿å»¶ç»­ | åšå¤š | â­â­â­â­ |
| downtrend_continuation | ä¸‹è·Œè¶‹åŠ¿å»¶ç»­ | åšç©º | â­â­â­â­ |
| ranging_oversold | éœ‡è¡å¸‚è¶…å– | å‡å€¼å›å½’åšå¤š | â­â­â­ |
| ranging_overbought | éœ‡è¡å¸‚è¶…ä¹° | å‡å€¼å›å½’åšç©º | â­â­â­ |
| ranging_neutral | éœ‡è¡å¸‚ä¸­æ€§ | è§‚æœ› | â­ |
| no_clear_signal | æ— æ˜ç¡®ä¿¡å· | è§‚æœ› | â­ |

### B. å†³ç­–ä¼˜å…ˆçº§çŸ©é˜µ

| åœºæ™¯ | æ­¥éª¤1 åˆ†æ‰¹æ­¢ç›ˆ | æ­¥éª¤2 ç§»åŠ¨æ­¢æŸ | æ­¥éª¤3 è¶‹åŠ¿åè½¬ | æœ€ç»ˆå†³ç­– |
|-----|-------------|-------------|-------------|---------|
| ç›ˆåˆ©è¾¾1Rï¼Œæ— åè½¬ | âœ… æ‰§è¡Œ | â­ï¸ è·³è¿‡ | â­ï¸ è·³è¿‡ | åˆ†æ‰¹å¹³ä»“33% |
| ç›ˆåˆ©0.8Rï¼Œæ— åè½¬ | âŒ æœªè¾¾æ ‡ | âœ… æ‰§è¡Œ | â­ï¸ è·³è¿‡ | ä¸Šç§»æ­¢æŸ |
| ç›ˆåˆ©1Rï¼Œæœ‰åè½¬ | âœ… æ‰§è¡Œ | â­ï¸ è·³è¿‡ | âš ï¸ å†²çª | ä¼˜å…ˆåˆ†æ‰¹ï¼Œæš‚ä¸å…¨å¹³ |
| äºæŸ5%ï¼Œæœ‰åè½¬ | âŒ ä¸é€‚ç”¨ | âŒ ä¸é€‚ç”¨ | âš ï¸ å»ºè®®å¹³ä»“ | AIåˆ¤æ–­æ˜¯å¦å¹³ä»“ |
| ç›ˆåˆ©20%ï¼Œæœ‰åè½¬ | âœ… å·²æ‰§è¡Œ3æ¬¡ | âœ… ç§»åŠ¨æ­¢æŸä¸­ | â„¹ï¸ å‚è€ƒ | ç»§ç»­ç§»åŠ¨æ­¢æŸ |

### C. å¼€å‘æ¸…å•

#### å¿…é¡»å®Œæˆ

- [ ] åœ¨ `generateTradingPrompt()` ä¸­æ‰¹é‡åˆ†æå¸‚åœºçŠ¶æ€
- [ ] åœ¨æŒä»“ä¿¡æ¯ä¸­è¿½åŠ è¶‹åŠ¿åˆ†æå­—æ®µ
- [ ] å®ç° `detectReversalSignal()` å‡½æ•°
- [ ] å®ç° `getReversalRecommendation()` å‡½æ•°
- [ ] åœ¨ `openPosition` ä¸­è®°å½•å…¥åœºå¸‚åœºçŠ¶æ€
- [ ] æ›´æ–°æ­¥éª¤3çš„æç¤ºè¯æè¿°
- [ ] æ·»åŠ æµ‹è¯•è„šæœ¬

#### å¯é€‰ä¼˜åŒ–

- [ ] åœ¨æ•°æ®åº“ä¸­è®°å½•å†å²è¶‹åŠ¿å˜åŒ–ï¼ˆç”¨äºå›æµ‹ï¼‰
- [ ] å¢åŠ è¶‹åŠ¿åè½¬çš„å¯è§†åŒ–ç›‘æ§
- [ ] ç»Ÿè®¡è¶‹åŠ¿åè½¬è¯†åˆ«çš„å‡†ç¡®ç‡
- [ ] æ ¹æ®åè½¬ä¿¡å·è°ƒæ•´åˆ†æ‰¹æ­¢ç›ˆé˜ˆå€¼

---

## é—®é¢˜è¿½è¸ª

- **åˆ›å»ºæ—¶é—´**: 2025-11-13
- **æ›´æ–°æ—¶é—´**: 2025-11-13 (v2.0)
- **ä¼˜å…ˆçº§**: é«˜
- **çŠ¶æ€**: å¾…å®¡é˜…ï¼ˆå·²é‡æ„ï¼‰
- **é¢„è®¡å®Œæˆ**: ç¡®è®¤å1ä¸ªå·¥ä½œæ—¥å†…
- **è´Ÿè´£äºº**: å¾…åˆ†é…

---

- *æœ¬æ–¹æ¡ˆ v2.0 åŸºäºå¯¹AIå†³ç­–æµç¨‹çš„æ·±åº¦åˆ†æé‡æ–°è®¾è®¡ï¼Œç¡®ä¿ä¸ç°æœ‰é£æ§ä½“ç³»æ— å†²çª*

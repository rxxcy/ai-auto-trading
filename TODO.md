# çŠ¶æ€è‡ªé€‚åº”å¼€ä»“ç³»ç»Ÿ - å®Œæ•´å®æ–½æ–¹æ¡ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### æ ¸å¿ƒé—®é¢˜

å½“å‰äº¤æ˜“ç³»ç»Ÿçš„**å¼€ä»“æ–¹å‘å†³ç­–è¿‡äºä¾èµ–æ—¶æœºï¼ˆè¿æ°”ï¼‰ï¼Œç¼ºä¹å¯¹å¸‚åœºçŠ¶æ€çš„é€‚åº”æ€§**ã€‚

**ğŸ¯ ä¼˜åŒ–é‡ç‚¹**ï¼š

- âœ… **é£æ§ç³»ç»Ÿï¼ˆæ­¢æŸ/æ­¢ç›ˆï¼‰å·²ç»éå¸¸å®Œå–„** - åŒ…æ‹¬ç§‘å­¦æ­¢æŸã€åˆ†æ‰¹æ­¢ç›ˆã€R-Multipleã€æ³¢åŠ¨ç‡è‡ªé€‚åº”ç­‰
- âŒ **"è¿›æ”»ç«¯"ï¼ˆå¼€ä»“å†³ç­–ï¼‰éœ€è¦å‡çº§** - è¿™æ˜¯å½“å‰ç³»ç»Ÿçš„å”¯ä¸€è–„å¼±ç¯èŠ‚

> âš ï¸ **é‡è¦åŸåˆ™**ï¼šæœ¬æ¬¡ä¼˜åŒ–ä»…é’ˆå¯¹å¼€ä»“å†³ç­–ç³»ç»Ÿï¼Œ**ä¸ä¿®æ”¹ç°æœ‰çš„æ­¢æŸ/æ­¢ç›ˆæœºåˆ¶**ï¼

### é—®é¢˜è¯Šæ–­

1. **ç­–ç•¥å•ä¸€åŒ–**ï¼šåªåœ¨æŸç§å¸‚åœºç¯å¢ƒä¸‹æœ‰æ•ˆï¼ˆå¼ºè¶‹åŠ¿å¸‚ï¼‰ï¼Œåœ¨éœ‡è¡å¸‚æˆ–åè½¬å¸‚å®¹æ˜“è¢«åå¤æ­¢æŸ
2. **ç¼ºä¹å¸‚åœºçŠ¶æ€è¯†åˆ«**ï¼šæ— æ³•åˆ¤æ–­å½“å‰æ˜¯"è¶‹åŠ¿å¸‚"ã€"éœ‡è¡å¸‚"è¿˜æ˜¯"è¶…å–åå¼¹å¸‚"
3. **å¼€ä»“ä¿¡å·æ¨¡ç³Š**ï¼š`è¯†åˆ«åŒå‘æœºä¼šï¼ˆåšå¤š/åšç©ºï¼‰`çš„è§„åˆ™ä¸æ¸…æ™°ï¼Œå¯¼è‡´å†³ç­–æ‘‡æ‘†
4. **é€‰å¸é€»è¾‘ç¼ºå¤±**ï¼šæ²¡æœ‰æ˜ç¡®çš„"å“ªä¸ªå¸ç§æœ€é€‚åˆå½“å‰å¼€ä»“"çš„è¯„åˆ†æœºåˆ¶

### è§£å†³æ–¹æ¡ˆ

æ„å»ºä¸€ä¸ª**çŠ¶æ€è‡ªé€‚åº”çš„å¼€ä»“ç³»ç»Ÿ**ï¼Œä¸“æ³¨äºä»¥ä¸‹ä¸‰å¤§æ¨¡å—ï¼š

- **ğŸ” å¸‚åœºçŠ¶æ€è¯†åˆ«å¼•æ“**ï¼šè‡ªåŠ¨åˆ¤æ–­æ¯ä¸ªå¸ç§å¤„äºä»€ä¹ˆå¸‚åœºçŠ¶æ€ï¼ˆè¶‹åŠ¿/éœ‡è¡/è¶…ä¹°è¶…å–ï¼‰
- **ğŸ¯ ç­–ç•¥è·¯ç”±å™¨**ï¼šæ ¹æ®å¸‚åœºçŠ¶æ€é€‰æ‹©æœ€ä¼˜å¼€ä»“ç­–ç•¥ï¼ˆè¶‹åŠ¿è·Ÿè¸ª/å‡å€¼å›å½’/çªç ´ï¼‰
- **ğŸ“Š æœºä¼šè¯„åˆ†ç³»ç»Ÿ**ï¼šå¯¹æ‰€æœ‰å¸ç§çš„å¼€ä»“æœºä¼šè¿›è¡Œé‡åŒ–è¯„åˆ†ï¼Œé€‰å‡ºæœ€ä½³æ ‡çš„

---

## ğŸ¯ å®æ–½è·¯çº¿å›¾

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è®¾æ–½ï¼ˆ1-2å¤©ï¼‰ğŸ”§

**ç›®æ ‡**ï¼šå»ºç«‹å¸‚åœºçŠ¶æ€è¯†åˆ«çš„åŸºç¡€æ¡†æ¶

**âš ï¸ æ³¨æ„**ï¼šæœ¬é˜¶æ®µåªåˆ›å»ºæ–°æœåŠ¡ï¼Œä¸ä¿®æ”¹ç°æœ‰çš„æ­¢æŸ/æ­¢ç›ˆç›¸å…³ä»£ç ï¼

#### ä»»åŠ¡ 1.1ï¼šåˆ›å»ºå¸‚åœºçŠ¶æ€è¯†åˆ«æœåŠ¡

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/services/marketStateAnalyzer.ts` ï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰
- [x] **åŠŸèƒ½**ï¼š
  - è¶‹åŠ¿å¼ºåº¦åˆ¤æ–­ï¼ˆåŸºäº EMA20/EMA50 å…³ç³»ï¼Œ1å°æ—¶çº§åˆ«ï¼‰
  - è¶…ä¹°è¶…å–åˆ¤æ–­ï¼ˆåŸºäº RSI7/RSI14ï¼Œ15åˆ†é’Ÿçº§åˆ«ï¼‰
  - æ³¢åŠ¨ç‡çŠ¶æ€ï¼ˆåŸºäº ATRï¼Œåˆ¤æ–­å¸‚åœºæ´»è·ƒåº¦ï¼‰
  - å¤šæ—¶é—´æ¡†æ¶ä¸€è‡´æ€§æ£€æŸ¥ï¼ˆ15åˆ†é’Ÿ + 1å°æ—¶ï¼‰
  - **ä»·æ ¼ä¸å…³é”®å‡çº¿çš„ä½ç½®å…³ç³»**ï¼ˆåç¦»åº¦è®¡ç®—ï¼‰
- [x] **è¾“å‡º**ï¼šè¿”å›æ˜ç¡®çš„å¸‚åœºçŠ¶æ€æšä¸¾ + ç½®ä¿¡åº¦è¯„åˆ†

  ```typescript
  type MarketState = 
    | "uptrend_oversold"      // ä¸Šæ¶¨è¶‹åŠ¿ä¸­çš„è¶…å–å›è°ƒï¼ˆæœ€ä½³åšå¤šï¼‰â­â­â­â­â­
    | "downtrend_overbought"  // ä¸‹è·Œè¶‹åŠ¿ä¸­çš„è¶…ä¹°åå¼¹ï¼ˆæœ€ä½³åšç©ºï¼‰â­â­â­â­â­
    | "uptrend_continuation"  // ä¸Šæ¶¨è¶‹åŠ¿å»¶ç»­ï¼ˆç¨³å¥åšå¤šï¼‰â­â­â­â­
    | "downtrend_continuation"// ä¸‹è·Œè¶‹åŠ¿å»¶ç»­ï¼ˆç¨³å¥åšç©ºï¼‰â­â­â­â­
    | "ranging_oversold"      // éœ‡è¡å¸‚è¶…å–ï¼ˆå‡å€¼å›å½’åšå¤šï¼‰â­â­â­
    | "ranging_overbought"    // éœ‡è¡å¸‚è¶…ä¹°ï¼ˆå‡å€¼å›å½’åšç©ºï¼‰â­â­â­
    | "ranging_neutral"       // éœ‡è¡å¸‚ä¸­æ€§ï¼ˆè§‚æœ›ï¼‰â­
    | "no_clear_signal";      // æ— æ˜ç¡®ä¿¡å·ï¼ˆè§‚æœ›ï¼‰â­
  ```

#### ä»»åŠ¡ 1.2ï¼šæ‰©å±•å¤šæ—¶é—´æ¡†æ¶åˆ†ææœåŠ¡

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/services/multiTimeframeAnalysis.ts` ï¼ˆæ‰©å±•ç°æœ‰æ–‡ä»¶ï¼‰
- [x] **æ–°å¢åŠŸèƒ½**ï¼ˆä¸ä¿®æ”¹ç°æœ‰åŠŸèƒ½ï¼‰ï¼š
  - âœ… æ·»åŠ å¸ƒæ—å¸¦è®¡ç®—ï¼ˆBollinger Bandsï¼Œä¸ºå‡å€¼å›å½’ç­–ç•¥å‡†å¤‡ï¼‰
  - âœ… æ·»åŠ  MACD æŸ±çŠ¶çº¿æ‹ç‚¹æ£€æµ‹ï¼ˆåŠ¨é‡åè½¬ä¿¡å·ï¼‰
  - âœ… æ·»åŠ è¿‘æœŸé«˜ä½ç‚¹è¯†åˆ«ï¼ˆæ”¯æ’‘/é˜»åŠ›ä½ï¼‰
  - âœ… æ·»åŠ è¶‹åŠ¿ä¸€è‡´æ€§è¯„åˆ†æ–¹æ³•ï¼ˆå¤šæ—¶é—´æ¡†æ¶å¯¹é½åº¦ï¼‰
  - âœ… æ·»åŠ ä»·æ ¼åç¦»åº¦è®¡ç®—ï¼ˆè·ç¦»å…³é”®å‡çº¿çš„ç™¾åˆ†æ¯”ï¼‰

#### ä»»åŠ¡ 1.3ï¼šåˆ›å»ºå¸‚åœºçŠ¶æ€ç±»å‹å®šä¹‰

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/types/marketState.ts` ï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰
- [x] **å†…å®¹**ï¼š
  - å¸‚åœºçŠ¶æ€æšä¸¾ï¼ˆMarketStateï¼‰
  - çŠ¶æ€åˆ†æç»“æœæ¥å£ï¼ˆMarketStateAnalysisï¼‰
  - ç­–ç•¥æ¨èæ¥å£ï¼ˆStrategyRecommendationï¼‰
  - æœºä¼šè¯„åˆ†æ¥å£ï¼ˆOpportunityScoreï¼‰

---

### ç¬¬äºŒé˜¶æ®µï¼šå­ç­–ç•¥å®ç°ï¼ˆ3-5å¤©ï¼‰ğŸ”§

**ç›®æ ‡**ï¼šå®ç°ä¸åŒå¸‚åœºçŠ¶æ€ä¸‹çš„å…·ä½“å¼€ä»“ç­–ç•¥

**âš ï¸ æ³¨æ„**ï¼š

- ç­–ç•¥åªè´Ÿè´£ç”Ÿæˆ"å¼€ä»“å»ºè®®"ï¼ˆæ–¹å‘ã€å…¥åœºä»·ã€æ¨èæ æ†ï¼‰
- **æ­¢æŸ/æ­¢ç›ˆçš„è®¡ç®—äº¤ç»™ç°æœ‰ç³»ç»Ÿå¤„ç†**ï¼ˆç§‘å­¦æ­¢æŸã€R-Multipleæ­¢ç›ˆç­‰ï¼‰
- ç­–ç•¥ä¸ä¿®æ”¹é£æ§å‚æ•°ï¼Œåªæä¾›"ä¿¡å·å¼ºåº¦"ä¾›é£æ§ç³»ç»Ÿå‚è€ƒ

#### ä»»åŠ¡ 2.1ï¼šè¶‹åŠ¿è·Ÿè¸ªç­–ç•¥

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/strategies/trendFollowingStrategy.ts` ï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰
- [x] **åšå¤šä¿¡å·**ï¼š
  - âœ… æ¡ä»¶ï¼š1å°æ—¶ EMA20 > EMA50ï¼ˆä¸Šæ¶¨è¶‹åŠ¿ç¡®è®¤ï¼‰
  - âœ… æ¡ä»¶ï¼š1å°æ—¶ MACD > 0ï¼ˆåŠ¨é‡å‘ä¸Šï¼‰
  - âœ… æ¡ä»¶ï¼š15åˆ†é’Ÿ RSI7 < 30ï¼ˆçŸ­æœŸè¶…å–å›è°ƒï¼‰
  - âœ… æ¡ä»¶ï¼šä»·æ ¼å›åˆ° EMA20 ä¸Šæ–¹ï¼ˆå›è°ƒç»“æŸï¼‰
  - âœ… è¾“å‡ºï¼šå¼€ä»“æ–¹å‘ã€ä¿¡å·å¼ºåº¦ï¼ˆ0-1ï¼‰ã€æ¨èæ æ†å€æ•°
- [x] **åšç©ºä¿¡å·**ï¼š
  - âœ… æ¡ä»¶ï¼š1å°æ—¶ EMA20 < EMA50ï¼ˆä¸‹è·Œè¶‹åŠ¿ç¡®è®¤ï¼‰
  - âœ… æ¡ä»¶ï¼š1å°æ—¶ MACD < 0ï¼ˆåŠ¨é‡å‘ä¸‹ï¼‰
  - âœ… æ¡ä»¶ï¼š15åˆ†é’Ÿ RSI7 > 70ï¼ˆçŸ­æœŸè¶…ä¹°åå¼¹ï¼‰
  - âœ… æ¡ä»¶ï¼šä»·æ ¼è·Œç ´ EMA20ï¼ˆåå¼¹ç»“æŸï¼‰
  - âœ… è¾“å‡ºï¼šå¼€ä»“æ–¹å‘ã€ä¿¡å·å¼ºåº¦ã€æ¨èæ æ†å€æ•°

#### ä»»åŠ¡ 2.2ï¼šå‡å€¼å›å½’ç­–ç•¥ï¼ˆå½“å‰å¸‚åœºæœ€é€‚ç”¨ï¼‰

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/strategies/meanReversionStrategy.ts` ï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰
- [x] **åšå¤šä¿¡å·**ï¼š
  - âœ… æ¡ä»¶ï¼š15åˆ†é’Ÿ RSI7 < 25ï¼ˆæç«¯è¶…å–ï¼‰
  - âœ… æ¡ä»¶ï¼šä»·æ ¼è§¦åŠå¸ƒæ—å¸¦ä¸‹è½¨ï¼ˆåç¦»å‡å€¼ï¼‰
  - âœ… æ¡ä»¶ï¼šMACD æŸ±çŠ¶çº¿æ‹å¤´å‘ä¸Šï¼ˆåŠ¨é‡åè½¬ä¿¡å·ï¼‰
  - âœ… æ¡ä»¶ï¼š1å°æ—¶è¶‹åŠ¿ä¸æ˜¯å¼ºçƒˆä¸‹è·Œï¼ˆé¿å…æŠ„åº•ä¸‹è·Œåˆ€ï¼‰
  - âœ… è¾“å‡ºï¼šå¼€ä»“æ–¹å‘ã€ä¿¡å·å¼ºåº¦ã€æ¨èæ æ†å€æ•°ï¼ˆæ›´ä¿å®ˆï¼‰
  - ğŸ“ **é‡è¦**ï¼šå‡å€¼å›å½’ç­–ç•¥ä½¿ç”¨æ›´ä¿å®ˆçš„æ æ†ï¼ˆæ¨è2-3å€ï¼Œè€Œé5å€ï¼‰
- [x] **åšç©ºä¿¡å·**ï¼š
  - âœ… æ¡ä»¶ï¼š15åˆ†é’Ÿ RSI7 > 75ï¼ˆæç«¯è¶…ä¹°ï¼‰
  - âœ… æ¡ä»¶ï¼šä»·æ ¼è§¦åŠå¸ƒæ—å¸¦ä¸Šè½¨
  - âœ… æ¡ä»¶ï¼šMACD æŸ±çŠ¶çº¿æ‹å¤´å‘ä¸‹
  - âœ… æ¡ä»¶ï¼š1å°æ—¶è¶‹åŠ¿ä¸æ˜¯å¼ºçƒˆä¸Šæ¶¨
  - âœ… è¾“å‡ºï¼šå¼€ä»“æ–¹å‘ã€ä¿¡å·å¼ºåº¦ã€æ¨èæ æ†å€æ•°

#### ä»»åŠ¡ 2.3ï¼šçªç ´ç­–ç•¥

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/strategies/breakoutStrategy.ts` ï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰
- [x] **åšå¤šä¿¡å·**ï¼š
  - âœ… æ¡ä»¶ï¼šä»·æ ¼çªç ´è¿‘æœŸå…³é”®é˜»åŠ›ä½ï¼ˆæœ€è¿‘20æ ¹Kçº¿çš„é«˜ç‚¹ï¼‰
  - âœ… æ¡ä»¶ï¼šçªç ´æ—¶æˆäº¤é‡æ”¾å¤§ï¼ˆ>1.5å€å¹³å‡é‡ï¼‰
  - âœ… æ¡ä»¶ï¼š1å°æ—¶ MACD > 0ï¼ˆè¶‹åŠ¿å‘ä¸Šï¼‰
  - âœ… æ¡ä»¶ï¼šRSI7 åœ¨40-70ä¹‹é—´ï¼ˆé¿å…è¿½é«˜ï¼‰
  - âœ… è¾“å‡ºï¼šå¼€ä»“æ–¹å‘ã€ä¿¡å·å¼ºåº¦ã€æ¨èæ æ†å€æ•°
- [x] **åšç©ºä¿¡å·**ï¼š
  - âœ… æ¡ä»¶ï¼šä»·æ ¼è·Œç ´è¿‘æœŸå…³é”®æ”¯æ’‘ä½
  - âœ… æ¡ä»¶ï¼šçªç ´æ—¶æˆäº¤é‡æ”¾å¤§
  - âœ… æ¡ä»¶ï¼š1å°æ—¶ MACD < 0
  - âœ… æ¡ä»¶ï¼šRSI7 åœ¨30-60ä¹‹é—´
  - âœ… è¾“å‡ºï¼šå¼€ä»“æ–¹å‘ã€ä¿¡å·å¼ºåº¦ã€æ¨èæ æ†å€æ•°

#### ä»»åŠ¡ 2.4ï¼šç­–ç•¥é€šç”¨å·¥å…·å‡½æ•°

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/strategies/strategyUtils.ts` ï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰
- [x] **åŠŸèƒ½**ï¼š
  - âœ… ä¿¡å·å¼ºåº¦è¯„åˆ†ï¼ˆ0-1ï¼Œç»¼åˆå¤šä¸ªæŒ‡æ ‡ï¼‰
  - âœ… å¤šæ—¶é—´æ¡†æ¶ç¡®è®¤æ£€æŸ¥ï¼ˆ15åˆ†é’Ÿå’Œ1å°æ—¶æ˜¯å¦ä¸€è‡´ï¼‰
  - âœ… æ³¢åŠ¨ç‡è°ƒæ•´ç³»æ•°è®¡ç®—ï¼ˆATRé«˜æ—¶é™ä½æ æ†å»ºè®®ï¼‰
  - âœ… ç­–ç•¥ç»“æœæ ‡å‡†åŒ–ï¼ˆç»Ÿä¸€è¾“å‡ºæ ¼å¼ï¼‰
  - âœ… è®¡ç®—ä»·æ ¼åç¦»åº¦ï¼ˆè·ç¦»å…³é”®å‡çº¿çš„ç™¾åˆ†æ¯”ï¼‰
  - âœ… MACDæŸ±çŠ¶çº¿æ‹ç‚¹æ£€æµ‹
  - âœ… è¿‘æœŸé«˜ä½ç‚¹è¯†åˆ«ï¼ˆæ”¯æ’‘/é˜»åŠ›ä½ï¼‰
  - âœ… æˆäº¤é‡å¼‚å¸¸æ£€æµ‹

---

### ç¬¬ä¸‰é˜¶æ®µï¼šç­–ç•¥è·¯ç”±ä¸æœºä¼šè¯„åˆ†ï¼ˆ2-3å¤©ï¼‰ğŸ”€

**ç›®æ ‡**ï¼šæ ¹æ®å¸‚åœºçŠ¶æ€è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç­–ç•¥ï¼Œå¹¶å¯¹æ‰€æœ‰å¸ç§è¿›è¡Œé‡åŒ–è¯„åˆ†

**âš ï¸ æ³¨æ„**ï¼šæœ¬é˜¶æ®µåªæ¶‰åŠå¼€ä»“å†³ç­–ï¼Œä¸ä¿®æ”¹ç°æœ‰çš„æŒä»“ç®¡ç†å’Œé£æ§ç³»ç»Ÿï¼

#### ä»»åŠ¡ 3.1ï¼šåˆ›å»ºç­–ç•¥è·¯ç”±å™¨

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/services/strategyRouter.ts` ï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰
- [x] **æ ¸å¿ƒé€»è¾‘**ï¼šæ ¹æ®å¸‚åœºçŠ¶æ€è‡ªåŠ¨è·¯ç”±åˆ°æœ€ä¼˜ç­–ç•¥

#### ä»»åŠ¡ 3.2ï¼šåˆ›å»ºæœºä¼šè¯„åˆ†ç³»ç»Ÿ

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/services/opportunityScorer.ts` ï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰
- [x] **åŠŸèƒ½**ï¼šå¯¹æ¯ä¸ªå¸ç§çš„å¼€ä»“æœºä¼šè¿›è¡Œ0-100åˆ†çš„é‡åŒ–è¯„åˆ†
- [x] **è¯„åˆ†ç»´åº¦**ï¼š
  - âœ… **ä¿¡å·å¼ºåº¦** (30åˆ†)ï¼šæŠ€æœ¯æŒ‡æ ‡çš„å¯¹é½ç¨‹åº¦
  - âœ… **è¶‹åŠ¿ä¸€è‡´æ€§** (25åˆ†)ï¼šå¤šæ—¶é—´æ¡†æ¶æ˜¯å¦ä¸€è‡´
  - âœ… **æ³¢åŠ¨ç‡é€‚é…** (20åˆ†)ï¼šå½“å‰æ³¢åŠ¨ç‡æ˜¯å¦é€‚åˆäº¤æ˜“
  - âœ… **é£é™©æ”¶ç›Šæ¯”** (15åˆ†)ï¼šé¢„æœŸç›ˆåˆ©ç©ºé—´ä¸æ­¢æŸè·ç¦»çš„æ¯”å€¼
  - âœ… **å¸‚åœºæ´»è·ƒåº¦** (10åˆ†)ï¼šæˆäº¤é‡å’ŒæµåŠ¨æ€§
- [x] **è¾“å‡º**ï¼šè¿”å›æ’åºåçš„æœºä¼šåˆ—è¡¨ï¼Œåªä¿ç•™è¯„åˆ†>60åˆ†çš„æœºä¼š

#### ä»»åŠ¡ 3.3ï¼šç­–ç•¥ç»“æœæ ‡å‡†åŒ–

- [x] **å®Œæˆ**ï¼šå·²åœ¨ `src/types/marketState.ts` ä¸­å®šä¹‰

#### ä»»åŠ¡ 3.4ï¼šå¤šå¸ç§å¹¶å‘åˆ†æ

- [x] **ä¼˜åŒ–**ï¼šä½¿ç”¨ Promise.all å¹¶å‘åˆ†ææ‰€æœ‰å¸ç§ï¼ˆæé«˜æ•ˆç‡ï¼‰
- [x] **è¿‡æ»¤**ï¼šè‡ªåŠ¨è¿‡æ»¤æ‰å·²æœ‰æŒä»“çš„å¸ç§ï¼ˆå·²åœ¨é›†æˆé˜¶æ®µå®ç°ï¼‰
- [x] **æ’åº**ï¼šæŒ‰æœºä¼šè¯„åˆ†ä»é«˜åˆ°ä½æ’åº
- [x] **é™åˆ¶**ï¼šè¿”å›å‰Nä¸ªæœ€ä½³æœºä¼šï¼ˆå¯é…ç½®ï¼‰
- [x] **è¾“å‡º**ï¼šè¿”å›æ’åºåçš„æœºä¼šåˆ—è¡¨ï¼Œåªä¿ç•™è¯„åˆ†>60åˆ†çš„æœºä¼š

---

### ç¬¬å››é˜¶æ®µï¼šé›†æˆåˆ°äº¤æ˜“å¾ªç¯ï¼ˆ2-3å¤©ï¼‰ğŸ”— âœ… å·²å®Œæˆ

**ç›®æ ‡**ï¼šå°†æ–°ç³»ç»Ÿé›†æˆåˆ°ç°æœ‰äº¤æ˜“æµç¨‹

**âš ï¸ é‡è¦**ï¼šé›†æˆæ—¶è¦ç‰¹åˆ«æ³¨æ„**ä¸ä¿®æ”¹ç°æœ‰çš„æ­¢æŸ/æ­¢ç›ˆè®¡ç®—é€»è¾‘**ï¼

**ğŸ“‹ å®Œæˆæ€»ç»“**ï¼š

- âœ… æ ¸å¿ƒå·¥å…· `analyzeOpeningOpportunities` å·²åˆ›å»ºå¹¶é›†æˆåˆ° TradingAgent
- âœ… æ”¯æŒè‡ªåŠ¨è¯†åˆ«å¸‚åœºçŠ¶æ€ã€ç­–ç•¥è·¯ç”±ã€é‡åŒ–è¯„åˆ†ã€æŒä»“è¿‡æ»¤
- âœ… æ•°æ®åº“ schema å·²æ‰©å±•ï¼Œæ–°å¢ market_stateã€strategy_typeã€signal_strengthã€opportunity_score å­—æ®µ
- âœ… æ•°æ®åº“è¿ç§»è„šæœ¬å·²åˆ›å»ºå¹¶æˆåŠŸæ‰§è¡Œï¼ˆmigrate-add-strategy-info.tsï¼‰
- âœ… TradingAgent ç³»ç»Ÿæç¤ºè¯å·²æ›´æ–°ï¼ŒæŒ‡å¯¼ AI æ­£ç¡®ä½¿ç”¨æ–°å·¥å…·
- âœ… é›†æˆæµ‹è¯•è„šæœ¬å·²åˆ›å»ºï¼Œè¦†ç›–å·¥å…·è°ƒç”¨ã€ç»“æœæ ¼å¼ã€æ•°æ®åº“å­—æ®µéªŒè¯
- âœ… ç¼–è¯‘æ£€æŸ¥é€šè¿‡ï¼Œæ—  TypeScript é”™è¯¯
- âœ… ä¸ç°æœ‰é£æ§ç³»ç»Ÿå®Œå…¨å…¼å®¹ï¼Œä¸å½±å“æ­¢æŸ/æ­¢ç›ˆæœºåˆ¶

#### ä»»åŠ¡ 4.1ï¼šåˆ›å»ºå¼€ä»“æœºä¼šåˆ†æå·¥å…·ï¼ˆæ ¸å¿ƒå·¥å…·ï¼‰

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/tools/trading/opportunityAnalysis.ts` ï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰
- [x] **åŠŸèƒ½æè¿°**ï¼šè¿™æ˜¯ TradingAgent è°ƒç”¨çš„ä¸»è¦å·¥å…·ï¼Œç”¨äºè·å–å½“å‰æœ€ä½³å¼€ä»“æœºä¼š
- [x] **æ ¸å¿ƒæµç¨‹**ï¼š
  1. è·å–æ‰€æœ‰äº¤æ˜“å¯¹çš„å¸‚åœºæ•°æ®ï¼ˆå¹¶å‘è¯·æ±‚ï¼‰
  2. å¯¹æ¯ä¸ªå¸ç§è¿›è¡Œå¸‚åœºçŠ¶æ€åˆ†æ
  3. è°ƒç”¨ç­–ç•¥è·¯ç”±å™¨ç”Ÿæˆå¼€ä»“å»ºè®®
  4. ä½¿ç”¨æœºä¼šè¯„åˆ†ç³»ç»Ÿè¿›è¡Œé‡åŒ–è¯„åˆ†
  5. è¿‡æ»¤æ‰å·²æœ‰æŒä»“çš„å¸ç§
  6. è¿”å›è¯„åˆ†æœ€é«˜çš„å‰5ä¸ªæœºä¼š
- [x] **è¾“å‡ºæ ¼å¼**ï¼šåŒ…å«è¯„åˆ†ã€åŠ¨ä½œã€å¸‚åœºçŠ¶æ€ã€ç­–ç•¥ç±»å‹ã€æ¨èæ æ†ã€å…³é”®æŒ‡æ ‡ç­‰

#### ä»»åŠ¡ 4.2ï¼šä¿®æ”¹ TradingAgent æç¤ºè¯

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/agents/tradingAgent.ts` ï¼ˆgenerateInstructions æ–¹æ³•ï¼‰
- [x] **ä¿®æ”¹å†…å®¹**ï¼š
  - âœ… åœ¨"æ–°å¼€ä»“è¯„ä¼°"éƒ¨åˆ†æ·»åŠ è¯´æ˜ï¼šç³»ç»Ÿå·²æä¾› `analyze_opening_opportunities` å·¥å…·
  - âœ… å¼ºè°ƒï¼šå·¥å…·å·²è‡ªåŠ¨è¯†åˆ«å¸‚åœºçŠ¶æ€å¹¶é€‰æ‹©æœ€ä¼˜ç­–ç•¥
  - âœ… è¯´æ˜ï¼šAI åº”è¯¥åŸºäºå·¥å…·è¿”å›çš„é‡åŒ–è¯„åˆ†åšå†³ç­–ï¼Œä½†ä¿ç•™æœ€ç»ˆå†³ç­–æƒ
  - âœ… æ·»åŠ ä½¿ç”¨å»ºè®®ï¼šè¯„åˆ†â‰¥80åˆ†ä¸ºé«˜è´¨é‡æœºä¼šï¼Œ60-79åˆ†ä¸ºä¸­ç­‰æœºä¼š
  - âœ… **ä¸ä¿®æ”¹**æ­¢æŸ/æ­¢ç›ˆç›¸å…³çš„æç¤ºè¯å†…å®¹

#### ä»»åŠ¡ 4.3ï¼šæ‰©å±• openPosition å·¥å…·ï¼ˆè®°å½•ç­–ç•¥ä¿¡æ¯ï¼‰

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/tools/trading/tradeExecution.ts` ï¼ˆå·²é€šè¿‡æ•°æ®åº“ schema æ‰©å±•å®ç°ï¼‰
- [x] **æ–°å¢å¯é€‰å‚æ•°**ï¼šå·²é€šè¿‡æ•°æ®åº“å­—æ®µæ”¯æŒ

  ```typescript
  {
    marketState?: string;          // å¸‚åœºçŠ¶æ€ï¼ˆå¦‚ "uptrend_oversold"ï¼‰
    strategyType?: string;          // ç­–ç•¥ç±»å‹ï¼ˆå¦‚ "trend_following"ï¼‰
    signalStrength?: number;        // ä¿¡å·å¼ºåº¦ 0-1
    opportunityScore?: number;      // æœºä¼šè¯„åˆ† 0-100
  }
  ```

- [x] **æ•°æ®åº“è®°å½•**ï¼šç­–ç•¥ä¿¡æ¯å·²é€šè¿‡ schema æ‰©å±•å­˜å…¥ `positions` è¡¨
- [x] **æ—¥å¿—å¢å¼º**ï¼šå¼€ä»“æ—¶çš„ç­–ç•¥ä¿¡æ¯ä¼šè‡ªåŠ¨è®°å½•
- [x] âš ï¸ **ä¸ä¿®æ”¹**ï¼šå¼€ä»“çš„é£æ§å‚æ•°è®¡ç®—é€»è¾‘ï¼ˆæ æ†ã€æ­¢æŸã€æ­¢ç›ˆç­‰ç»§ç»­ä½¿ç”¨ç°æœ‰ç³»ç»Ÿï¼‰

#### ä»»åŠ¡ 4.4ï¼šæ•°æ®åº“ Schema æ‰©å±• âœ…

- [x] **æ–‡ä»¶è·¯å¾„**ï¼š`src/database/schema.ts` âœ… å·²å®Œæˆ
- [x] **æ–°å¢å­—æ®µ**ï¼ˆæ·»åŠ åˆ° `positions` è¡¨ï¼‰ï¼š

  ```typescript
  marketState: text('market_state'),           // å¼€ä»“æ—¶çš„å¸‚åœºçŠ¶æ€
  strategyType: text('strategy_type'),         // ä½¿ç”¨çš„ç­–ç•¥ç±»å‹
  signalStrength: real('signal_strength'),     // ä¿¡å·å¼ºåº¦
  opportunityScore: real('opportunity_score'), // æœºä¼šè¯„åˆ†
  ```

- [x] **åˆ›å»ºè¿ç§»è„šæœ¬**ï¼š`src/database/migrate-add-strategy-info.ts` âœ… å·²åˆ›å»ºå¹¶æˆåŠŸæ‰§è¡Œ
- [x] **ç›®çš„**ï¼šæ–¹ä¾¿åç»­åˆ†æä¸åŒç­–ç•¥çš„è¡¨ç°

#### ä»»åŠ¡ 4.5ï¼šé›†æˆæµ‹è¯•

- [x] **æµ‹è¯•è„šæœ¬åˆ›å»º**ï¼š`scripts/test-integration-phase4.ts` å·²åˆ›å»º
- [x] **æµ‹è¯•åœºæ™¯1**ï¼šè°ƒç”¨ `analyzeOpeningOpportunities` å·¥å…·ï¼ŒéªŒè¯è¿”å›ç»“æœæ ¼å¼æ­£ç¡® âœ…
- [x] **æµ‹è¯•åœºæ™¯2**ï¼šéªŒè¯å¸‚åœºçŠ¶æ€è¯†åˆ«å’Œç­–ç•¥è·¯ç”±é€»è¾‘ âœ…
- [x] **æµ‹è¯•åœºæ™¯3**ï¼šéªŒè¯æ•°æ®åº“æ–°å­—æ®µå¯æ­£å¸¸å­˜å– âœ…
- [x] **æµ‹è¯•åœºæ™¯4**ï¼šéªŒè¯ä¸ç°æœ‰ç³»ç»Ÿçš„å…¼å®¹æ€§ âœ…
- [x] **æ—¥å¿—æ£€æŸ¥**ï¼šç¡®ä¿ç­–ç•¥å†³ç­–è¿‡ç¨‹æœ‰è¯¦ç»†æ—¥å¿—è®°å½• âœ…
- [x] **æ•°æ®åº“è¿ç§»éªŒè¯**ï¼šæ–°å­—æ®µå·²æˆåŠŸæ·»åŠ åˆ° positions è¡¨ âœ…

#### ä»»åŠ¡ 4.6ï¼šçªç ´ç­–ç•¥Kçº¿æ•°æ®ä¿®å¤ âœ… **[2025-11-12]**

- [x] **é—®é¢˜è¯†åˆ«**ï¼šçªç ´ç­–ç•¥çš„ `candles` å­—æ®µè¢«ç¡¬ç¼–ç ä¸ºç©ºæ•°ç»„ `[]`ï¼Œå¯¼è‡´ç­–ç•¥æ— æ³•è¯†åˆ«å…³é”®æ”¯æ’‘/é˜»åŠ›ä½
- [x] **æ–‡ä»¶ä¿®æ”¹1**ï¼š`src/services/multiTimeframeAnalysis.ts`
  - âœ… åœ¨ `TimeframeIndicators` æ¥å£ä¸­æ·»åŠ  `candles: any[]` å­—æ®µ
  - âœ… åœ¨ `analyzeTimeframe` å‡½æ•°è¿”å›å€¼ä¸­ä¿ç•™åŸå§‹Kçº¿æ•°æ®
  - âœ… ç¡®ä¿Kçº¿æ•°æ®å®Œæ•´ä¼ é€’ï¼ˆ96æ ¹15åˆ†é’ŸKçº¿ï¼Œ120æ ¹1å°æ—¶Kçº¿ï¼‰
- [x] **æ–‡ä»¶ä¿®æ”¹2**ï¼š`src/strategies/breakoutStrategy.ts`
  - âœ… ä¿®æ”¹ `breakoutStrategy` åŒ…è£…å‡½æ•°ï¼Œä½¿ç”¨ `tf15m.candles` è€Œéç¡¬ç¼–ç ç©ºæ•°ç»„
  - âœ… åŒæ—¶ä¿®å¤ `macdSignal` å­—æ®µä¼ é€’ï¼ˆä½¿ç”¨ `tf15m.macdSignal || 0`ï¼‰
- [x] **æµ‹è¯•éªŒè¯**ï¼š`scripts/test-breakout-strategy.ts`
  - âœ… BTC/USDT: æˆåŠŸè·å–96æ ¹15åˆ†é’ŸKçº¿ï¼Œè¯†åˆ«å‡ºè¿‘æœŸé«˜ç‚¹104861.3ï¼Œä½ç‚¹102857.5
  - âœ… ETH/USDT: æˆåŠŸè·å–96æ ¹15åˆ†é’ŸKçº¿ï¼Œè¯†åˆ«å‡ºè¿‘æœŸé«˜ç‚¹3543.4ï¼Œä½ç‚¹3448.83
  - âœ… SOL/USDT: æˆåŠŸè·å–96æ ¹15åˆ†é’ŸKçº¿ï¼Œè¯†åˆ«å‡ºæ”¯æ’‘ä½çªç ´ï¼ˆä»·æ ¼157.82 < æ”¯æ’‘157.74ï¼‰
  - âœ… SOLçªç ´åšç©ºä¿¡å·ï¼šä¿¡å·å¼ºåº¦56.9%ï¼Œåˆç†è­¦å‘Šï¼ˆæˆäº¤é‡æœªæ”¾å¤§1.46xï¼ŒRSI7è¿‡ä½19.2ï¼‰
- [x] **ç¼–è¯‘æ£€æŸ¥**ï¼šTypeScriptç¼–è¯‘é€šè¿‡ï¼Œæ— é”™è¯¯
- [x] **å½±å“èŒƒå›´**ï¼šä»…å½±å“çªç ´ç­–ç•¥ï¼Œå…¶ä»–ç­–ç•¥ï¼ˆè¶‹åŠ¿è·Ÿè¸ªã€å‡å€¼å›å½’ï¼‰ä¸å—å½±å“
- [x] **ä¿®å¤æ•ˆæœ**ï¼šçªç ´ç­–ç•¥ç°åœ¨èƒ½æ­£ç¡®è¯†åˆ«å…³é”®æ”¯æ’‘/é˜»åŠ›ä½ï¼Œå¹¶ç»™å‡ºåˆç†çš„äº¤æ˜“ä¿¡å·

**ä¿®å¤æ€»ç»“**ï¼š

- ğŸ¯ **æ ¸å¿ƒé—®é¢˜**ï¼šKçº¿å†å²æ•°æ®æœªä¼ é€’ï¼Œå¯¼è‡´çªç ´ç­–ç•¥æ°¸è¿œè¿”å› `wait`
- âœ… **è§£å†³æ–¹æ¡ˆ**ï¼šåœ¨å¤šæ—¶é—´æ¡†æ¶åˆ†æä¸­ä¿ç•™å¹¶ä¼ é€’ `candles` å­—æ®µ
- ğŸ“Š **éªŒè¯ç»“æœ**ï¼šçªç ´ç­–ç•¥æˆåŠŸè¯†åˆ«SOL/USDTçš„æ”¯æ’‘ä½çªç ´æœºä¼šï¼ˆè¯„åˆ†56.9%ï¼‰
- ğŸ” **åç»­ä¼˜åŒ–**ï¼šéœ€æŒç»­ç›‘æµ‹çªç ´ç­–ç•¥çš„å®ç›˜è¡¨ç°ï¼Œæ ¹æ®æ•°æ®è°ƒæ•´å‚æ•°

---

### ç¬¬äº”é˜¶æ®µï¼šå½“å‰å¸‚åœºå¿«é€ŸéªŒè¯ï¼ˆ1å¤©ï¼‰ğŸš€

**ç›®æ ‡**ï¼šåœ¨å½“å‰æç«¯è¶…å–å¸‚åœºç¯å¢ƒä¸‹ï¼Œå¿«é€ŸéªŒè¯ç³»ç»Ÿæœ‰æ•ˆæ€§

**èƒŒæ™¯**ï¼šæ ¹æ®å½“å‰æ•°æ®ï¼Œå¤šä¸ªå¸ç§å¤„äºæç«¯è¶…å–çŠ¶æ€ï¼ˆRSI7 < 20ï¼‰ï¼Œè¿™æ˜¯å‡å€¼å›å½’ç­–ç•¥çš„ç†æƒ³æµ‹è¯•åœºæ™¯ã€‚

#### ä»»åŠ¡ 5.1ï¼šåˆ›å»ºå¸‚åœºåˆ†æè„šæœ¬

- [ ] **æ–‡ä»¶è·¯å¾„**ï¼š`scripts/analyze-current-market.ts` ï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰
- [ ] **åŠŸèƒ½**ï¼š
  - ä½¿ç”¨æ–°çš„å¸‚åœºçŠ¶æ€åˆ†æå™¨åˆ†ææ‰€æœ‰äº¤æ˜“å¯¹
  - è¯†åˆ«æç«¯è¶…å–å¸ç§ï¼ˆRSI7 < 20ï¼‰
  - åˆ¤æ–­æ˜¯å¦é€‚åˆå‡å€¼å›å½’ç­–ç•¥
  - è¾“å‡ºå½“å‰æœ€ä½³çš„5ä¸ªå¼€ä»“æœºä¼š
  - è¾“å‡ºæ ¼å¼å‹å¥½ï¼Œä¾¿äºäººå·¥éªŒè¯
- [ ] **ä½¿ç”¨æ–¹å¼**ï¼š`npm run analyze-market` æˆ– `ts-node scripts/analyze-current-market.ts`

#### ä»»åŠ¡ 5.2ï¼šé…ç½®ç¯å¢ƒå˜é‡

- [ ] **æ–‡ä»¶è·¯å¾„**ï¼š`.env`
- [ ] **æ–°å¢é…ç½®**ï¼š

  ```bash

  # æœºä¼šè¯„åˆ†é…ç½®
  MIN_OPPORTUNITY_SCORE=60         # æœ€ä½æœºä¼šè¯„åˆ†ï¼ˆ0-100ï¼‰
  MAX_OPPORTUNITIES_TO_SHOW=5      # æœ€å¤šæ˜¾ç¤ºæœºä¼šæ•°
  ```

<!-- #### ä»»åŠ¡ 5.3ï¼šç›‘æ§é¢æ¿å¢å¼º

- [ ] **æ–‡ä»¶è·¯å¾„**ï¼š`public/index.html` å’Œ `public/monitor-script.js`
- [ ] **æ–°å¢æ˜¾ç¤ºåŒºåŸŸ**ï¼š
  - ğŸ“Š "å¸‚åœºçŠ¶æ€æ€»è§ˆ" é¢æ¿ï¼ˆæ˜¾ç¤ºå„å¸ç§çš„å¸‚åœºçŠ¶æ€åˆ†å¸ƒï¼‰
  - ğŸ¯ "å½“å‰æœ€ä½³æœºä¼š" é¢æ¿ï¼ˆå®æ—¶æ˜¾ç¤ºè¯„åˆ†æœ€é«˜çš„5ä¸ªæœºä¼šï¼‰
  - ğŸ“ˆ "ç­–ç•¥åˆ†å¸ƒ" é¢æ¿ï¼ˆæ˜¾ç¤ºå½“å‰æŒä»“ä½¿ç”¨çš„ç­–ç•¥ç±»å‹åˆ†å¸ƒï¼‰
- [ ] **API æ”¯æŒ**ï¼šåœ¨ `src/api/routes.ts` ä¸­æ·»åŠ æ–°æ¥å£ï¼š
  - `GET /api/market-states` - è·å–æ‰€æœ‰å¸ç§çš„å¸‚åœºçŠ¶æ€
  - `GET /api/top-opportunities` - è·å–å½“å‰æœ€ä½³æœºä¼š
  - `GET /api/strategy-stats` - è·å–ç­–ç•¥ç»Ÿè®¡ä¿¡æ¯ -->

#### ä»»åŠ¡ 5.4ï¼šå°è§„æ¨¡å®ç›˜æµ‹è¯•

- [ ] **æµ‹è¯•å‚æ•°**ï¼š
  - ä»…ä½¿ç”¨ 1-2 ä¸ªå¸ç§è¿›è¡Œæµ‹è¯•
  - ä½¿ç”¨æœ€å°ä»“ä½ï¼ˆè´¦æˆ·çš„5-10%ï¼‰
  - ä½¿ç”¨è¾ƒä½æ æ†ï¼ˆ2-3å€ï¼‰
  - è®¾ç½®ä¸¥æ ¼æ­¢æŸï¼ˆ5%ï¼‰
- [ ] **æµ‹è¯•ç›®æ ‡**ï¼š
  - éªŒè¯å¸‚åœºçŠ¶æ€è¯†åˆ«å‡†ç¡®æ€§
  - éªŒè¯ç­–ç•¥é€‰æ‹©é€»è¾‘æ­£ç¡®
  - éªŒè¯å¼€ä»“æ‰§è¡Œæµç¨‹æ­£å¸¸
  - **éªŒè¯ç°æœ‰æ­¢æŸ/æ­¢ç›ˆç³»ç»Ÿæœªè¢«å½±å“**
- [ ] **æµ‹è¯•æ—¶é•¿**ï¼š24-48å°æ—¶
- [ ] **æˆåŠŸæ ‡å‡†**ï¼š
  - ç³»ç»Ÿæ­£å¸¸è¿è¡Œæ— é”™è¯¯
  - ç­–ç•¥ä¿¡æ¯æ­£ç¡®è®°å½•
  - è‡³å°‘æ‰§è¡Œ1æ¬¡å®Œæ•´äº¤æ˜“ï¼ˆå¼€ä»“åˆ°å¹³ä»“ï¼‰

---

## ğŸ“Š æ ¸å¿ƒä»£ç ç¤ºä¾‹

> ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºå…³é”®æ¨¡å—çš„å®ç°æ€è·¯ï¼Œå®é™…å¼€å‘æ—¶æ ¹æ®é¡¹ç›®å…·ä½“æƒ…å†µè°ƒæ•´ã€‚

### ç¤ºä¾‹ 1ï¼šæœºä¼šè¯„åˆ†ç³»ç»Ÿï¼ˆæ–°å¢æ¨¡å—ï¼‰

```typescript
// src/services/opportunityScorer.ts

export interface OpportunityScore {
  symbol: string;
  totalScore: number; // 0-100
  breakdown: {
    signalStrength: number;      // 30åˆ†
    trendConsistency: number;    // 25åˆ†
    volatilityFit: number;       // 20åˆ†
    riskRewardRatio: number;     // 15åˆ†
    liquidity: number;           // 10åˆ†
  };
}

export function scoreOpportunity(
  symbol: string,
  marketState: MarketStateAnalysis,
  strategyResult: StrategyResult
): OpportunityScore {
  // 1. ä¿¡å·å¼ºåº¦è¯„åˆ† (0-30åˆ†)
  const signalScore = strategyResult.signalStrength * 30;
  
  // 2. è¶‹åŠ¿ä¸€è‡´æ€§è¯„åˆ† (0-25åˆ†)
  const trendScore = calculateTrendConsistency(marketState) * 25;
  
  // 3. æ³¢åŠ¨ç‡é€‚é…è¯„åˆ† (0-20åˆ†)
  const volatilityScore = calculateVolatilityFit(marketState) * 20;
  
  // 4. é£é™©æ”¶ç›Šæ¯”è¯„åˆ† (0-15åˆ†)
  const rrScore = calculateRiskRewardScore(strategyResult) * 15;
  
  // 5. æµåŠ¨æ€§è¯„åˆ† (0-10åˆ†)
  const liquidityScore = calculateLiquidityScore(symbol) * 10;
  
  return {
    symbol,
    totalScore: signalScore + trendScore + volatilityScore + rrScore + liquidityScore,
    breakdown: {
      signalStrength: signalScore,
      trendConsistency: trendScore,
      volatilityFit: volatilityScore,
      riskRewardRatio: rrScore,
      liquidity: liquidityScore
    }
  };
}
```

### ç¤ºä¾‹ 2ï¼šanalyzeOpeningOpportunities å·¥å…·ï¼ˆæ ¸å¿ƒå·¥å…·ï¼‰

```typescript
// src/services/marketStateAnalyzer.ts

export interface MarketStateAnalysis {
  symbol: string;
  state: MarketState;
  trendStrength: "trending_up" | "trending_down" | "ranging";
  momentumState: "oversold_extreme" | "oversold_mild" | "neutral" | "overbought_mild" | "overbought_extreme";
  volatilityState: "high_vol" | "normal_vol" | "low_vol";
  confidence: number; // 0-1
  keyMetrics: {
    rsi7_15m: number;
    rsi14_15m: number;
    ema20_1h: number;
    ema50_1h: number;
    macd_1h: number;
    atr_ratio: number; // å½“å‰ATR / å¹³å‡ATR
    price: number;
    distanceToEMA: number; // ä»·æ ¼è·ç¦»EMA20çš„ç™¾åˆ†æ¯”
  };
}

export async function analyzeMarketState(
  symbol: string,
  marketData: any
): Promise<MarketStateAnalysis> {
  // 1. è¶‹åŠ¿åˆ¤æ–­ï¼ˆ1å°æ—¶æ¡†æ¶ï¼‰
  const ema20_1h = marketData.multiTimeframe['1h'].EMA20;
  const ema50_1h = marketData.multiTimeframe['1h'].EMA50;
  const macd_1h = marketData.multiTimeframe['1h'].MACD;
  const price = marketData.price;
  
  let trendStrength: "trending_up" | "trending_down" | "ranging";
  
  if (ema20_1h > ema50_1h && macd_1h > 0) {
    trendStrength = price > ema20_1h ? "trending_up" : "trending_up"; // ä¸Šæ¶¨è¶‹åŠ¿
  } else if (ema20_1h < ema50_1h && macd_1h < 0) {
    trendStrength = price < ema20_1h ? "trending_down" : "trending_down"; // ä¸‹è·Œè¶‹åŠ¿
  } else {
    trendStrength = "ranging"; // éœ‡è¡
  }
  
  // 2. è¶…ä¹°è¶…å–åˆ¤æ–­ï¼ˆ15åˆ†é’Ÿæ¡†æ¶ï¼‰
  const rsi7_15m = marketData.multiTimeframe['15m'].RSI7;
  const rsi14_15m = marketData.multiTimeframe['15m'].RSI14;
  
  let momentumState: any;
  if (rsi7_15m < 20) {
    momentumState = "oversold_extreme";
  } else if (rsi7_15m < 30) {
    momentumState = "oversold_mild";
  } else if (rsi7_15m > 80) {
    momentumState = "overbought_extreme";
  } else if (rsi7_15m > 70) {
    momentumState = "overbought_mild";
  } else {
    momentumState = "neutral";
  }
  
  // 3. æ³¢åŠ¨ç‡çŠ¶æ€
  const atr_14 = marketData.multiTimeframe['1h'].ATR14;
  const avg_atr = marketData.avgATR; // éœ€è¦è®¡ç®—å†å²å¹³å‡ATR
  const atr_ratio = atr_14 / avg_atr;
  
  const volatilityState = atr_ratio > 1.5 ? "high_vol" : atr_ratio < 0.7 ? "low_vol" : "normal_vol";
  
  // 4. ç»¼åˆçŠ¶æ€åˆ¤æ–­
  let state: MarketState;
  let confidence = 0.5;
  
  if (trendStrength === "trending_up" && momentumState === "oversold_extreme") {
    state = "uptrend_oversold";
    confidence = 0.9; // é«˜ç½®ä¿¡åº¦
  } else if (trendStrength === "trending_down" && momentumState === "overbought_extreme") {
    state = "downtrend_overbought";
    confidence = 0.9;
  } else if (trendStrength === "trending_up" && (momentumState === "oversold_mild" || momentumState === "neutral")) {
    state = "uptrend_correction";
    confidence = 0.7;
  } else if (trendStrength === "trending_down" && (momentumState === "overbought_mild" || momentumState === "neutral")) {
    state = "downtrend_rally";
    confidence = 0.7;
  } else if (trendStrength === "ranging" && momentumState === "oversold_extreme") {
    state = "ranging_oversold";
    confidence = 0.8;
  } else if (trendStrength === "ranging" && momentumState === "overbought_extreme") {
    state = "ranging_overbought";
    confidence = 0.8;
  } else {
    state = "no_clear_signal";
    confidence = 0.3;
  }
  
  return {
    symbol,
    state,
    trendStrength,
    momentumState,
    volatilityState,
    confidence,
    keyMetrics: {
      rsi7_15m,
      rsi14_15m,
      ema20_1h,
      ema50_1h,
      macd_1h,
      atr_ratio,
      price,
      distanceToEMA: ((price - ema20_1h) / price) * 100
    }
  };
}

---

## ğŸ§ª æµ‹è¯•ä¸éªŒè¯

### å•å…ƒæµ‹è¯•

- [ ] å¸‚åœºçŠ¶æ€è¯†åˆ«å‡†ç¡®æ€§æµ‹è¯•ï¼ˆå‡†ç¡®ç‡ >80%ï¼‰
- [ ] ç­–ç•¥è·¯ç”±é€»è¾‘æµ‹è¯•ï¼ˆç¡®ä¿çŠ¶æ€åˆ°ç­–ç•¥çš„æ˜ å°„æ­£ç¡®ï¼‰
- [ ] æœºä¼šè¯„åˆ†ç®—æ³•æµ‹è¯•ï¼ˆè¯„åˆ†ä¸å®é™…è¡¨ç°çš„ç›¸å…³æ€§ï¼‰

### é›†æˆæµ‹è¯•

- [ ] å®Œæ•´äº¤æ˜“å¾ªç¯æµ‹è¯•ï¼ˆä»åˆ†æåˆ°å¼€ä»“åˆ°å¹³ä»“ï¼‰
- [ ] å¤šå¸ç§å¹¶å‘åˆ†ææµ‹è¯•ï¼ˆæ€§èƒ½å’Œå‡†ç¡®æ€§ï¼‰
- [ ] æç«¯å¸‚åœºæ¡ä»¶æµ‹è¯•ï¼ˆè¶…å–/è¶…ä¹°/æš´æ¶¨/æš´è·Œï¼‰
- [ ] **é£æ§ç³»ç»Ÿå…¼å®¹æ€§æµ‹è¯•**ï¼ˆç¡®ä¿ä¸å½±å“ç°æœ‰æ­¢æŸ/æ­¢ç›ˆï¼‰

### å›æµ‹æµ‹è¯•ï¼ˆå¯é€‰ï¼Œç¬¬äºŒæœŸä¼˜åŒ–ï¼‰

- [ ] ä½¿ç”¨å†å²æ•°æ®å›æµ‹å„å­ç­–ç•¥è¡¨ç°
- [ ] å¯¹æ¯”å•ä¸€ç­–ç•¥ vs å¤šç­–ç•¥åˆ‡æ¢çš„æ•ˆæœ
- [ ] åˆ†æä¸åŒå¸‚åœºç¯å¢ƒä¸‹çš„èƒœç‡

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡ä¸ç›‘æ§

### å…³é”®æŒ‡æ ‡ï¼ˆ3ä¸ªæœˆåè¯„ä¼°ï¼‰

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | è¯´æ˜ |
|------|--------|------|
| **å¼€ä»“èƒœç‡** | >60% | å¼€ä»“åæœ€ç»ˆç›ˆåˆ©çš„æ¯”ä¾‹ |
| **ç­–ç•¥å‘½ä¸­ç‡** | >75% | å¸‚åœºçŠ¶æ€è¯†åˆ«å‡†ç¡®æ€§ |
| **å¹³å‡ç›ˆäºæ¯”** | >1.5 | å¹³å‡ç›ˆåˆ©/å¹³å‡äºæŸ |
| **å¤æ™®æ¯”ç‡** | >1.5 | é£é™©è°ƒæ•´åçš„æ”¶ç›Š |
| **æœ€å¤§å›æ’¤** | <20% | ä»å³°å€¼çš„æœ€å¤§è·Œå¹… |

### ç›‘æ§é¢æ¿å¢å¼º

- [ ] **å¸‚åœºçŠ¶æ€çœ‹æ¿**ï¼šå®æ—¶æ˜¾ç¤ºæ‰€æœ‰å¸ç§çš„å¸‚åœºçŠ¶æ€ï¼ˆè¶‹åŠ¿/éœ‡è¡/è¶…ä¹°è¶…å–ï¼‰
- [ ] **æœºä¼šé›·è¾¾**ï¼šæ˜¾ç¤ºå½“å‰è¯„åˆ†æœ€é«˜çš„5ä¸ªå¼€ä»“æœºä¼š
- [ ] **ç­–ç•¥åˆ†å¸ƒå›¾**ï¼šæ˜¾ç¤ºå½“å‰æŒä»“ä½¿ç”¨çš„ç­–ç•¥ç±»å‹åˆ†å¸ƒï¼ˆé¥¼å›¾ï¼‰
- [ ] **ç­–ç•¥è¡¨ç°ç»Ÿè®¡**ï¼šå„ç­–ç•¥çš„èƒœç‡ã€å¹³å‡ç›ˆäºã€ç´¯è®¡æ”¶ç›Šï¼ˆè¡¨æ ¼ï¼‰

---

## âš ï¸ é£é™©æ§åˆ¶ä¸æ³¨æ„äº‹é¡¹

### ğŸ”’ ä¸¥æ ¼éµå®ˆçš„åŸåˆ™

1. **ä¸ä¿®æ”¹ç°æœ‰é£æ§ç³»ç»Ÿ**ï¼š
   - âœ… ç§‘å­¦æ­¢æŸç³»ç»Ÿä¿æŒä¸å˜
   - âœ… åˆ†æ‰¹æ­¢ç›ˆï¼ˆR-Multipleï¼‰ä¿æŒä¸å˜
   - âœ… æ³¢åŠ¨ç‡è‡ªé€‚åº”ç³»ç»Ÿä¿æŒä¸å˜
   - âœ… ç°æœ‰çš„é£é™©å‚æ•°ï¼ˆæœ€å¤§æŒä»“æ•°ã€æ æ†å€æ•°ç­‰ï¼‰ä¿æŒä¸å˜

2. **æ¸è¿›å¼éƒ¨ç½²**ï¼š
   - âœ… å…ˆå®Œæˆå¼€å‘å’Œæµ‹è¯•
   - âœ… å°è§„æ¨¡å®ç›˜éªŒè¯ï¼ˆ1-2ä¸ªå¸ç§ï¼Œå°ä»“ä½ï¼‰
   - âœ… éªŒè¯é€šè¿‡åé€æ­¥æ‰©å¤§è§„æ¨¡

3. **å®Œæ•´æ—¥å¿—è®°å½•**ï¼š
   - âœ… è®°å½•æ¯æ¬¡å¸‚åœºçŠ¶æ€åˆ†æç»“æœ
   - âœ… è®°å½•ç­–ç•¥é€‰æ‹©è¿‡ç¨‹å’Œç†ç”±
   - âœ… è®°å½•å¼€ä»“å†³ç­–çš„æ‰€æœ‰å‚æ•°
   - âœ… æ–¹ä¾¿åç»­åˆ†æå’Œä¼˜åŒ–

### æ–°å¢é£é™©ç‚¹ä¸åº”å¯¹

| é£é™©ç‚¹ | åº”å¯¹æªæ–½ |
|--------|----------|
| ç­–ç•¥é¢‘ç¹åˆ‡æ¢ | åŒä¸€å¸ç§15åˆ†é’Ÿå†…ä¸é‡å¤åˆ†æ |
| ä¿¡å·å†²çª | é€‰æ‹©ç½®ä¿¡åº¦æ›´é«˜çš„ç­–ç•¥ï¼Œè®°å½•å†²çªæƒ…å†µ |
| è¿‡åº¦æ‹Ÿåˆ | å®šæœŸåœ¨æ–°æ•°æ®ä¸ŠéªŒè¯ï¼Œä¿æŒç­–ç•¥ç®€å• |
| ç³»ç»Ÿå¤æ‚åº¦å¢åŠ  | å®Œå–„æ–‡æ¡£å’Œæ³¨é‡Šï¼Œå•å…ƒæµ‹è¯•è¦†ç›–ç‡>80% |

---

## ğŸ“ é…ç½®å‚æ•°æ±‡æ€»

### ç¯å¢ƒå˜é‡ï¼ˆæ–°å¢ï¼‰

```bash
# å¸‚åœºçŠ¶æ€è¯†åˆ«é˜ˆå€¼
OVERSOLD_EXTREME_THRESHOLD=20
OVERSOLD_MILD_THRESHOLD=30
OVERBOUGHT_EXTREME_THRESHOLD=80
OVERBOUGHT_MILD_THRESHOLD=70

# ç­–ç•¥å¼€å…³
ENABLE_TREND_FOLLOWING=true
ENABLE_MEAN_REVERSION=true
ENABLE_BREAKOUT=true

# æœºä¼šè¯„åˆ†é…ç½®
MIN_OPPORTUNITY_SCORE=60
MAX_OPPORTUNITIES_TO_SHOW=5

# ç­–ç•¥å‚æ•°
TREND_FOLLOWING_MIN_RSI=25
MEAN_REVERSION_MIN_RSI=20
BREAKOUT_VOLUME_THRESHOLD=1.5
```

---

## ğŸ“… å®æ–½æ—¶é—´è¡¨

| é˜¶æ®µ | æ—¶é•¿ | å…³é”®é‡Œç¨‹ç¢‘ |
|------|------|------------|
| **ç¬¬ä¸€é˜¶æ®µ** | 1-2å¤© | å¸‚åœºçŠ¶æ€è¯†åˆ«å™¨å®Œæˆå¹¶æµ‹è¯•é€šè¿‡ |
| **ç¬¬äºŒé˜¶æ®µ** | 3-5å¤© | ä¸‰ç§å­ç­–ç•¥å®ç°å¹¶æµ‹è¯•é€šè¿‡ |
| **ç¬¬ä¸‰é˜¶æ®µ** | 2-3å¤© | ç­–ç•¥è·¯ç”±å™¨å’Œæœºä¼šè¯„åˆ†ç³»ç»Ÿå®Œæˆ |
| **ç¬¬å››é˜¶æ®µ** | 2-3å¤© | é›†æˆåˆ°äº¤æ˜“å¾ªç¯ï¼Œå·¥å…·å¯ç”¨ |
| **ç¬¬äº”é˜¶æ®µ** | 1å¤© | å°è§„æ¨¡å®ç›˜æµ‹è¯•æˆåŠŸ |
| **æ€»è®¡** | **9-14å¤©** | ç³»ç»Ÿä¸Šçº¿å¹¶ç¨³å®šè¿è¡Œ |

---

## ğŸ¯ æˆåŠŸæ ‡å‡†ï¼ˆæœ€ç»ˆéªŒæ”¶ï¼‰

### çŸ­æœŸç›®æ ‡ï¼ˆ1ä¸ªæœˆå†…ï¼‰

- [ ] ç³»ç»Ÿç¨³å®šè¿è¡Œæ— ä¸¥é‡é”™è¯¯
- [ ] å¼€ä»“å†³ç­–æœ‰æ˜ç¡®çš„ç­–ç•¥ä¾æ®
- [ ] ç­–ç•¥ä¿¡æ¯å®Œæ•´è®°å½•åˆ°æ•°æ®åº“
- [ ] ç›‘æ§é¢æ¿æ­£å¸¸æ˜¾ç¤ºå¸‚åœºçŠ¶æ€
- [ ] **ç°æœ‰é£æ§ç³»ç»Ÿè¿è¡Œæ­£å¸¸ï¼Œæœªå—å½±å“**

### ä¸­æœŸç›®æ ‡ï¼ˆ3ä¸ªæœˆå†…ï¼‰

- [ ] å¼€ä»“èƒœç‡ç›¸æ¯”ä¼˜åŒ–å‰æå‡ >15%
- [ ] ç­–ç•¥å‘½ä¸­ç‡ï¼ˆå¸‚åœºçŠ¶æ€è¯†åˆ«å‡†ç¡®æ€§ï¼‰ >75%
- [ ] å¤æ™®æ¯”ç‡ >1.5
- [ ] æœ€å¤§å›æ’¤ <20%
- [ ] ç³»ç»Ÿåœ¨ä¸åŒå¸‚åœºç¯å¢ƒä¸‹éƒ½èƒ½ç¨³å®šè¿è¡Œ

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆç«‹å³å¯åšï¼‰

### å½“å‰å¸‚åœºæœºä¼š

æ ¹æ®æä¾›çš„æ•°æ®ï¼Œå½“å‰å¤šä¸ªå¸ç§å¤„äº**æç«¯è¶…å–çŠ¶æ€**ï¼ˆRSI7 < 20ï¼‰ï¼Œè¿™æ˜¯**å‡å€¼å›å½’ç­–ç•¥**çš„é»„é‡‘æœºä¼šï¼š

- **BTC**: RSI7=19.62ï¼ˆæç«¯è¶…å–ï¼Œä¸Šæ¶¨è¶‹åŠ¿ä¸­ï¼‰â­â­â­â­â­
- **HYPE**: RSI7=14.48ï¼ˆæç«¯è¶…å–ï¼‰â­â­â­â­
- **SUI**: RSI7=5.71ï¼ˆæç«¯è¶…å–ï¼Œè­¦æƒ•è¿‡åº¦è¶…å–ï¼‰â­â­â­

### ç¬¬ä¸€æ­¥ï¼šåˆ†æå½“å‰å¸‚åœº

åˆ›å»ºå¹¶è¿è¡Œå¸‚åœºåˆ†æè„šæœ¬ï¼š

```bash
npm run analyze-market
# æˆ–
ts-node scripts/analyze-current-market.ts
```

### ç¬¬äºŒæ­¥ï¼šéªŒè¯ç­–ç•¥é€»è¾‘

åœ¨æµ‹è¯•ç¯å¢ƒä¸­éªŒè¯å¸‚åœºçŠ¶æ€è¯†åˆ«å’Œç­–ç•¥é€‰æ‹©ï¼š

- æ‰‹åŠ¨æ£€æŸ¥å‡ ä¸ªå¸ç§çš„å¸‚åœºçŠ¶æ€æ˜¯å¦æ­£ç¡®
- éªŒè¯ç­–ç•¥è·¯ç”±é€»è¾‘æ˜¯å¦åˆç†
- ç¡®è®¤æœºä¼šè¯„åˆ†æ’åºæ­£ç¡®

### ç¬¬ä¸‰æ­¥ï¼šå°è§„æ¨¡å®ç›˜

- é€‰æ‹© **1-2ä¸ªå¸ç§**ï¼ˆå¦‚BTCï¼‰
- ä½¿ç”¨ **5-10%è´¦æˆ·èµ„é‡‘**
- ä½¿ç”¨ **2-3å€æ æ†**
- è¿è¡Œ **24-48å°æ—¶**

---

## ğŸ“š å­¦ä¹ èµ„æºï¼ˆå¯é€‰ï¼‰

- **ã€ŠTrading in the Zoneã€‹** - å¿ƒç†çºªå¾‹å’ŒçŠ¶æ€é€‚åº”
- **ã€ŠMean Reversion Trading Systemsã€‹** - å‡å€¼å›å½’ç­–ç•¥è¯¦è§£
- **ã€ŠTrend Followingã€‹** - è¶‹åŠ¿è·Ÿè¸ªç»å…¸ç†è®º
- **TradingView** - å¤šæ—¶é—´æ¡†æ¶åˆ†æå®è·µ

---

## ç»“è¯­

è¿™å¥—**çŠ¶æ€è‡ªé€‚åº”å¼€ä»“ç³»ç»Ÿ**å°†ä½¿æ‚¨çš„äº¤æ˜“ä»"é è¿æ°”"å‡çº§ä¸º"é ç³»ç»Ÿ"ã€‚é€šè¿‡æ™ºèƒ½è¯†åˆ«å¸‚åœºçŠ¶æ€å¹¶é€‰æ‹©æœ€ä¼˜ç­–ç•¥ï¼Œæ˜¾è‘—æé«˜å¼€ä»“èƒœç‡å’Œæ•´ä½“æ”¶ç›Šã€‚

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š

- âœ… èšç„¦å¼€ä»“å†³ç­–ä¼˜åŒ–ï¼ˆçœŸæ­£çš„è–„å¼±ç¯èŠ‚ï¼‰
- âœ… ä¸ä¿®æ”¹å®Œå–„çš„é£æ§ç³»ç»Ÿï¼ˆé¿å…å¼•å…¥æ–°é£é™©ï¼‰
- âœ… é‡åŒ–è¯„åˆ†ç³»ç»Ÿï¼ˆå‡å°‘ä¸»è§‚åˆ¤æ–­ï¼‰
- âœ… æ¸è¿›å¼å®æ–½ï¼ˆé™ä½é£é™©ï¼‰

**å½“å‰å¸‚åœºçš„æç«¯è¶…å–çŠ¶æ€æ­£æ˜¯æµ‹è¯•å’ŒéªŒè¯æ–°ç³»ç»Ÿçš„ç»ä½³æ—¶æœºï¼**

å¼€å§‹å®æ–½ï¼Œé€æ­¥æ¨è¿›ï¼ŒæŒç»­ä¼˜åŒ–ï¼ğŸš€
